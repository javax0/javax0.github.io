<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.1">Jekyll</generator><link href="https://javax0.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://javax0.github.io/" rel="alternate" type="text/html" /><updated>2023-06-05T15:26:44+02:00</updated><id>https://javax0.github.io/feed.xml</id><title type="html">Java Deep, mostly Java</title><subtitle>javax0 is a technical Java oriented blog. Whenever I find something interesting, in the mood and feel the power to publish it, you will get it here. Publications are usually released on Wednesday 15:00am GMT. Earlier posts of the blog were published on Javax0 Wordpress Site at https://javax0.wordpress.com</subtitle><entry><title type="html">Adding Mermaid Diagrams to Markdown Documents</title><link href="https://javax0.github.io/2023/06/05/mermaid-in-jamal.html" rel="alternate" type="text/html" title="Adding Mermaid Diagrams to Markdown Documents" /><published>2023-06-05T00:00:00+02:00</published><updated>2023-06-05T00:00:00+02:00</updated><id>https://javax0.github.io/2023/06/05/mermaid-in-jamal</id><content type="html" xml:base="https://javax0.github.io/2023/06/05/mermaid-in-jamal.html">&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Mermaid is a trendy diagramming tool.
A year ago, it was integrated into the Markdown rendering of Github.
(see &lt;a href=&quot;https://github.blog/2022-02-14-include-diagrams-markdown-files-mermaid/&quot; class=&quot;bare&quot;&gt;https://github.blog/2022-02-14-include-diagrams-markdown-files-mermaid/&lt;/a&gt;)
It is also integrated into several editors.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What can you do, however, if you use a different editor?
What if you want to use your Markdown document in an environment that does not integrate Mermaid yet?
What can you do if the diagram is not Mermaid but PlantUML, Graphviz, or any other diagramming tool?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article will show how you can integrate ANY diagram-as-code tool into your documents.
The technique works for Markdown, Asciidoc, APT, or any other text-based markup language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However, before anything else, here is a demonstration image, which was created the way I will describe in this article.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/javax0/javax0.github.io/master/assets/images/e8a96c341e35bf3594a44f6a47e198b17c60affc393db847a4e26f7ed05708b5.svg&quot; alt=&quot;e8a96c341e35bf3594a44f6a47e198b17c60affc393db847a4e26f7ed05708b5&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-problem-statement&quot;&gt;1. Problem Statement&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When documenting some systems, it is often necessary to include diagrams.
Keeping diagrams in separate files has advantages but also disadvantages.
It is easier to keep the consistency of the documentation when the different parts are close together.
The more distanced the two corresponding and related parts are, the more likely that one or the other becomes stale when the other is updated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is also a good idea if you can parameterize the diagram, and you could avoid copy-pasting diagram parameters from the document, the documented code, or the other way around.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To solve these problems, more and more markup languages support selected diagramming tool markups to embed in the text.
You can include Mermaid in Markdown documents if you target GitHub hosting for your document.
You can include PlantUML diagrams in Asciidoc documents.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What happens, however, if you want to include Mermaid in Asciidoc?
What if you need PlantUML in Markdown?
How do you solve the issue if you want to host your Markdown elsewhere besides GitHub?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can abandon your ideas, stick to the available tools or wait for a solution.
The latter approach, however, will always remain an issue.
There will always be a new tool you want to use, and you will have to wait for the support of that tool in your favorite markup language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The principal reason for this is an architectural mismatch.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Document markup languages must be responsible only for document structure and content and nothing else.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Embedding a diagramming tool into the markup language must not be implemented in these languages.
It is a separate concern with the document&amp;#8217;s programmability ensuring document consistency automation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The solution is to use a meta markup above the document markup.
This meta markup can be document markup agnostic and support all the diagramming tools you want to use.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-ideas-and-approach-to-solve-the-problem&quot;&gt;2. Ideas and Approach to Solve the problem&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The basic idea is not new: separation of concerns.
The document markup language should be responsible for the document structure and content.
The diagramming tool should be responsible for the diagramming.
The meta markup should be responsible for the integration.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since the meta markup is language agnostic, it can be used with any existing and future document markup languages.
There is no need to wait for the support of the diagramming tool in the document markup language.
The only question is the integration of the meta markup into the document markup language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The simplest and loosest way to integrate the meta markup is to use a preprocessor.
Processing the meta markup, we read and generate a text file.
The document markup processing tool catches where the meta markup has left off.
It has no idea that a program generates the document markup and is not manually edited.
Strictly speaking, when you edit a document markup, then the editor is the program that generates the file.
Technically, there is no difference.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are other possibilities.
Most document markups support different editors to deliver some form of WYSIWYG editing.
The meta markup preprocessor can be integrated into these editors.
That way, the document markup enriched with the meta markup can seamlessly be edited in the WYSIWYG editor.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The proposed meta markup and the implementing tool, Jamal, follow both approaches.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-suggested-solution-tools&quot;&gt;3. Suggested Solution, Tools&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The suggested solution is to use Jamal as the meta markup.
Jamal is a general-purpose macro processor.
There are other meta markup processing tools, like &lt;a href=&quot;https://facelessuser.github.io/pymdown-extensions/&quot;&gt;PyMdown&lt;/a&gt;.
These tools usually target a specific document markup and a specific purpose.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Jamal is a general-purpose, turning complete macro processor with more than 200 macros for different purposes.
These macros make your documents programmable to automate manual document maintenance tasks.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The general saying is: if you could give a task to an assistant to do, then you can automate it with Jamal.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Jamal has a PlantUML module.
PlantUML is written in Java, the development language I used to create Jamal.
It makes the integration of PlantUML into Jamal easy, and PlantUML diagrams embedded into the documentation can be converted in the process.
Jamal, however, is not limited to using only tools written in Java.
To demonstrate it, we will use the Mermaid diagramming tool, written in JavaScript and running with node.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since Mermaid is not a Java program, it cannot be executed inside the JVM.
We will create our documentation to execute Mermaid as a separate process.
Other diagramming tools can be integrated similarly if executed on the document processing machine.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-1-install-mermaid&quot;&gt;3.1. Install Mermaid&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first step is to install Mermaid.
The steps are documented on the &lt;a href=&quot;https://mermaid.sj.org&quot;&gt;Mermaid site&lt;/a&gt;.
I will not repeat the steps here because I do not want to create a document that gets outdated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On my machine, the installation creates the  &lt;code&gt;/usr/local/bin/mmdc&lt;/code&gt; executable.
This file is a JavaScript script that starts the Mermaid diagramming tool.
While executing from Jamal, I realized the process has a different environment than my login script.
To deal with that, I had to edit the file.
Instead of using the &lt;code&gt;env&lt;/code&gt; command to find the node interpreter, I specified the full path to the node executable.
Other installations may be different, and it does not affect the rest of the article.
It is a technical detail.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-2-install-jamal&quot;&gt;3.2. Install Jamal&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We will use Jamal as the meta markup processor.
The installation is detailed in the &lt;a href=&quot;https://github.com/verhas/jamal&quot;&gt;documentation of Jamal&lt;/a&gt;.
You can start it from the command line, as a Maven plugin, using Jbang and many other ways.
I recommend using it as a preprocessor integrated into the IntelliJ Asciidoctor plugin.
It will provide you with WYSIWYG editing of your document in Markdown and Asciidoc enriched with Jamal macros.
Also, the installation is nothing more than executing the command line&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;literalblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;mvn com.javax0.jamal:jamal-maven-plugin:2.1.0:jamalize&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;which will download the version 2.1.0 we use in this article by the time pre-release and copy all the needed files into your project&amp;#8217;s &lt;code&gt;.asciidoctor/lib&lt;/code&gt; directory.
It will make the macros available for the Asciidoctor plugin.
What needs manual work is configuring IntelliJ to treat all &lt;code&gt;.jam&lt;/code&gt; files as Asciidoc files.
That way, the editor will invoke the Asciidoctor plugin and use the Jamal preprocessor.
It is the setup that I also use to write the articles.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-3-create-the-macros-for-mermaid&quot;&gt;3.3. Create the macros for Mermaid&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To have a mermaid document inside the document, we should do three things using macros:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;Save the Mermaid text into a file.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Execute the Mermaid tool to convert the text into an SVG file.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Reference the SVG file as an image in the document.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Later, we will see how to save on Mermaid processing, executing it only when the Mermaid text changes.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We will use the &lt;code&gt;io:write&lt;/code&gt; macro to save the Mermaid text into a file.
This macro is in a package that is not loaded by default.
We have to load it explicitly.
To do that, we use the &lt;code&gt;maven:load&lt;/code&gt; macro.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{@maven:load com.javax0.jamal:jamal-io:2.1.0}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This macro package has to be configured as safe for the document in the &lt;code&gt;.jamal/settings.properties&lt;/code&gt; file as it is documented.
The macros in this package can read and write files and execute commands configured.
To use a macro package like that from an untrusted source is a security risk.
For this reason, every package loaded by the &lt;code&gt;maven:load&lt;/code&gt; macro has to be configured as safe.
The configuration specifies the package and the documents where it can be used.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At the same time, the io package also needs configuration to be able to execute the &lt;code&gt;mmdc&lt;/code&gt; command.
To do that, the configuration file contains a&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;literalblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;mermaid=/usr/local/bin/mmdc&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;line assigning a symbolic name to the actual command.
The &lt;code&gt;io:exec&lt;/code&gt; macro will use this symbolic name to find the command to execute.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When the macro package is loaded, we can use the &lt;code&gt;io:write&lt;/code&gt; macro as in the following sample:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{#define CHART=flowchart TD
A[Christmas] --&amp;gt;|Get money| B(Go shopping)
B --&amp;gt; C{Let me think}
C --&amp;gt;|One| D[Laptop]
C --&amp;gt;|Two| E[iPhone]
C --&amp;gt;|Three| F[fa:fa-car Care]
}
{#io:write (output=&quot;aaa.mmd&quot;) {CHART}}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When the file is created, we can execute the Mermaid tool to convert it into an SVG file, as the following&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{#io:exec command=&quot;&quot;&quot;mermaid
-i
aaa.mmd
-o
aaa.svg
&quot;&quot;&quot; cwd=&quot;.&quot; error=&quot;convert.err.txt&quot; output=&quot;convert.out.txt&quot;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;By that, we have the file.
Whenever the Mermaid text changes, the SVG file will be recreated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As a matter of fact, whenever the document changes, the SVG file will be recreated.
It wastes resources when the diagram remains the same and the processing runs interactively.
To help with that, we can use the &lt;code&gt;hashCode&lt;/code&gt; macro.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The macro &lt;code&gt;hashCode&lt;/code&gt; calculates the hash code of the text.
We will use the hash code to name the file.
Whenever the diagram changes, the file&amp;#8217;s name changes.
Also, if the file exists, it should contain the diagram for the current text.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To check that the file exists, we include it in the document.
Because we do not want the SVG text in the document, we surround the &lt;code&gt;include&lt;/code&gt; with the &lt;code&gt;block&lt;/code&gt; macro.
If the file does not exist, then an error will occur.
The macro &lt;code&gt;try&lt;/code&gt; will handle this error, and the execution will continue.
However, the macro &lt;code&gt;CREATE&lt;/code&gt; will be set to &lt;code&gt;true&lt;/code&gt; in this case.
If there is no error, when the file already exists, the macro &lt;code&gt;CREATE&lt;/code&gt; will be set to &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The &lt;code&gt;if&lt;/code&gt; macro will check the value of the macro &lt;code&gt;CREATE&lt;/code&gt;.
If it is &lt;code&gt;true&lt;/code&gt;, it will execute the &lt;code&gt;io:write&lt;/code&gt; and &lt;code&gt;io:exec&lt;/code&gt; macros to create the file.
If it is &lt;code&gt;false,&lt;/code&gt; then it will do nothing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{#define KEY={#hashCode {CHART}}}{@define CREATE=true}
{@try {#block{#include images/{KEY}.svg}}{@define CREATE=false}}
{#if `//`{CREATE}//
{#io:write (mkdir output=&quot;images/aaa.mmd&quot;) {CHART}}
{#io:exec command=&quot;&quot;&quot;mermaid
-i
images/aaa.mmd
-o
images/{KEY}.svg
&quot;&quot;&quot; cwd=&quot;.&quot; error=&quot;convert.err.txt&quot; output=&quot;convert.out.txt&quot;
}//}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For more details using these macros, please refer to the documentation.
If you intend to use multiple diagrams, you may want to create a macro that does all the steps above.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-summary-and-takeaway&quot;&gt;4. Summary and Takeaway&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article discussed integrating Mermaid diagrams into your Asciidoc, Markdown, or any other markup document.
We selected Mermaid for two reasons.
First, usually, this is the tool people ask for.
Second, this is an excellent example of a non-Java tool that can be integrated into document processing.
The described way can be applied to any external tool capable of running as a process.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The samples also demonstrate a complex structure of macros showing the power of the Jamal macro processor.
Such complexity is rarely needed.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In addition to the technology, I discussed, though only briefly, the separation of concerns for document handling and how the document formatting markup should be separated from the processing meta markup.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to have diagrams in your documentation, download Jamal, and start enhancing your documents.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author></entry><entry><title type="html">Adding Mermaid Diagrams to Markdown Documents</title><link href="https://javax0.github.io/2023/06/01/mermaid-in-jamal.html" rel="alternate" type="text/html" title="Adding Mermaid Diagrams to Markdown Documents" /><published>2023-06-01T00:00:00+02:00</published><updated>2023-06-01T00:00:00+02:00</updated><id>https://javax0.github.io/2023/06/01/mermaid-in-jamal</id><content type="html" xml:base="https://javax0.github.io/2023/06/01/mermaid-in-jamal.html">&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;images/e8a96c341e35bf3594a44f6a47e198b17c60affc393db847a4e26f7ed05708b5.svg&quot; alt=&quot;e8a96c341e35bf3594a44f6a47e198b17c60affc393db847a4e26f7ed05708b5&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Mermaid is a trendy diagramming tool.
A year ago, it was integrated into the Markdown rendering of Github.
(see &lt;a href=&quot;https://github.blog/2022-02-14-include-diagrams-markdown-files-mermaid/&quot; class=&quot;bare&quot;&gt;https://github.blog/2022-02-14-include-diagrams-markdown-files-mermaid/&lt;/a&gt;)
It is also integrated into several editors.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What can you do, however, if you use a different editor?
What if you want to use your Markdown document in an environment that does not integrate Mermaid yet?
What can you do if the diagram is not Mermaid but PlantUML, Graphviz, or any other diagramming tool?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article will show how you can integrate ANY diagram-as-code tool into your documents.
The technique works for Markdown, Asciidoc, APT, or any other text-based markup language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However, before anything else, here is a demonstration image, which was created the way I will describe in this article.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/javax0/javax0.github.io/master/assets/images/e8a96c341e35bf3594a44f6a47e198b17c60affc393db847a4e26f7ed05708b5.svg&quot; alt=&quot;e8a96c341e35bf3594a44f6a47e198b17c60affc393db847a4e26f7ed05708b5&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-problem-statement&quot;&gt;1. Problem Statement&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When documenting some systems, it is often necessary to include diagrams.
Keeping diagrams in separate files has advantages but also disadvantages.
It is easier to keep the consistency of the documentation when the different parts are close together.
The more distanced the two corresponding and related parts are, the more likely that one or the other becomes stale when the other is updated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is also a good idea if you can parameterize the diagram, and you could avoid copy-pasting diagram parameters from the document, the documented code, or the other way around.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To solve these problems, more and more markup languages support selected diagramming tool markups to embed in the text.
You can include Mermaid in Markdown documents if you target GitHub hosting for your document.
You can include PlantUML diagrams in Asciidoc documents.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What happens, however, if you want to include Mermaid in Asciidoc?
What if you need PlantUML in Markdown?
How do you solve the issue if you want to host your Markdown elsewhere besides GitHub?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can abandon your ideas, stick to the available tools or wait for a solution.
The latter approach, however, will always remain an issue.
There will always be a new tool you want to use, and you will have to wait for the support of that tool in your favorite markup language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The principal reason for this is an architectural mismatch.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Document markup languages must be responsible only for document structure and content and nothing else.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Embedding a diagramming tool into the markup language must not be implemented in these languages.
It is a separate concern with the document&amp;#8217;s programmability ensuring document consistency automation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The solution is to use a meta markup above the document markup.
This meta markup can be document markup agnostic and support all the diagramming tools you want to use.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-ideas-and-approach-to-solve-the-problem&quot;&gt;2. Ideas and Approach to Solve the problem&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The basic idea is not new: separation of concerns.
The document markup language should be responsible for the document structure and content.
The diagramming tool should be responsible for the diagramming.
The meta markup should be responsible for the integration.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since the meta markup is language agnostic, it can be used with any existing and future document markup languages.
There is no need to wait for the support of the diagramming tool in the document markup language.
The only question is the integration of the meta markup into the document markup language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The simplest and loosest way to integrate the meta markup is to use a preprocessor.
Processing the meta markup, we read and generate a text file.
The document markup processing tool catches where the meta markup has left off.
It has no idea that a program generates the document markup and is not manually edited.
Strictly speaking, when you edit a document markup, then the editor is the program that generates the file.
Technically, there is no difference.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are other possibilities.
Most document markups support different editors to deliver some form of WYSIWYG editing.
The meta markup preprocessor can be integrated into these editors.
That way, the document markup enriched with the meta markup can seamlessly be edited in the WYSIWYG editor.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The proposed meta markup and the implementing tool, Jamal, follow both approaches.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-suggested-solution-tools&quot;&gt;3. Suggested Solution, Tools&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The suggested solution is to use Jamal as the meta markup.
Jamal is a general-purpose macro processor.
There are other meta markup processing tools, like &lt;a href=&quot;https://facelessuser.github.io/pymdown-extensions/&quot;&gt;PyMdown&lt;/a&gt;.
These tools usually target a specific document markup and a specific purpose.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Jamal is a general-purpose, turning complete macro processor with more than 200 macros for different purposes.
These macros make your documents programmable to automate manual document maintenance tasks.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The general saying is: if you could give a task to an assistant to do, then you can automate it with Jamal.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Jamal has a PlantUML module.
PlantUML is written in Java, the development language I used to create Jamal.
It makes the integration of PlantUML into Jamal easy, and PlantUML diagrams embedded into the documentation can be converted in the process.
Jamal, however, is not limited to using only tools written in Java.
To demonstrate it, we will use the Mermaid diagramming tool, written in JavaScript and running with node.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since Mermaid is not a Java program, it cannot be executed inside the JVM.
We will create our documentation to execute Mermaid as a separate process.
Other diagramming tools can be integrated similarly if executed on the document processing machine.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-1-install-mermaid&quot;&gt;3.1. Install Mermaid&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first step is to install Mermaid.
The steps are documented on the &lt;a href=&quot;https://mermaid.sj.org&quot;&gt;Mermaid site&lt;/a&gt;.
I will not repeat the steps here because I do not want to create a document that gets outdated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On my machine, the installation creates the  &lt;code&gt;/usr/local/bin/mmdc&lt;/code&gt; executable.
This file is a JavaScript script that starts the Mermaid diagramming tool.
While executing from Jamal, I realized the process has a different environment than my login script.
To deal with that, I had to edit the file.
Instead of using the &lt;code&gt;env&lt;/code&gt; command to find the node interpreter, I specified the full path to the node executable.
Other installations may be different, and it does not affect the rest of the article.
It is a technical detail.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-2-install-jamal&quot;&gt;3.2. Install Jamal&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We will use Jamal as the meta markup processor.
The installation is detailed in the &lt;a href=&quot;https://github.com/verhas/jamal&quot;&gt;documentation of Jamal&lt;/a&gt;.
You can start it from the command line, as a Maven plugin, using Jbang and many other ways.
I recommend using it as a preprocessor integrated into the IntelliJ Asciidoctor plugin.
It will provide you with WYSIWYG editing of your document in Markdown and Asciidoc enriched with Jamal macros.
Also, the installation is nothing more than executing the command line&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;literalblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;mvn com.javax0.jamal:jamal-maven-plugin:2.1.0:jamalize&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;which will download the version 2.1.0 we use in this article by the time pre-release and copy all the needed files into your project&amp;#8217;s &lt;code&gt;.asciidoctor/lib&lt;/code&gt; directory.
It will make the macros available for the Asciidoctor plugin.
What needs manual work is configuring IntelliJ to treat all &lt;code&gt;.jam&lt;/code&gt; files as Asciidoc files.
That way, the editor will invoke the Asciidoctor plugin and use the Jamal preprocessor.
It is the setup that I also use to write the articles.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-3-create-the-macros-for-mermaid&quot;&gt;3.3. Create the macros for Mermaid&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To have a mermaid document inside the document, we should do three things using macros:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;Save the Mermaid text into a file.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Execute the Mermaid tool to convert the text into an SVG file.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Reference the SVG file as an image in the document.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Later, we will see how to save on Mermaid processing, executing it only when the Mermaid text changes.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We will use the &lt;code&gt;io:write&lt;/code&gt; macro to save the Mermaid text into a file.
This macro is in a package that is not loaded by default.
We have to load it explicitly.
To do that, we use the &lt;code&gt;maven:load&lt;/code&gt; macro.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{@maven:load com.javax0.jamal:jamal-io:2.1.0}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This macro package has to be configured as safe for the document in the &lt;code&gt;.jamal/settings.properties&lt;/code&gt; file as it is documented.
The macros in this package can read and write files and execute commands configured.
To use a macro package like that from an untrusted source is a security risk.
For this reason, every package loaded by the &lt;code&gt;maven:load&lt;/code&gt; macro has to be configured as safe.
The configuration specifies the package and the documents where it can be used.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At the same time, the io package also needs configuration to be able to execute the &lt;code&gt;mmdc&lt;/code&gt; command.
To do that, the configuration file contains a&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;literalblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;mermaid=/usr/local/bin/mmdc&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;line assigning a symbolic name to the actual command.
The &lt;code&gt;io:exec&lt;/code&gt; macro will use this symbolic name to find the command to execute.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When the macro package is loaded, we can use the &lt;code&gt;io:write&lt;/code&gt; macro as in the following sample:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{#define CHART=flowchart TD
A[Christmas] --&amp;gt;|Get money| B(Go shopping)
B --&amp;gt; C{Let me think}
C --&amp;gt;|One| D[Laptop]
C --&amp;gt;|Two| E[iPhone]
C --&amp;gt;|Three| F[fa:fa-car Care]
}
{#io:write (output=&quot;aaa.mmd&quot;) {CHART}}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When the file is created, we can execute the Mermaid tool to convert it into an SVG file, as the following&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{#io:exec command=&quot;&quot;&quot;mermaid
-i
aaa.mmd
-o
aaa.svg
&quot;&quot;&quot; cwd=&quot;.&quot; error=&quot;convert.err.txt&quot; output=&quot;convert.out.txt&quot;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;By that, we have the file.
Whenever the Mermaid text changes, the SVG file will be recreated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As a matter of fact, whenever the document changes, the SVG file will be recreated.
It wastes resources when the diagram remains the same and the processing runs interactively.
To help with that, we can use the &lt;code&gt;hashCode&lt;/code&gt; macro.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The macro &lt;code&gt;hashCode&lt;/code&gt; calculates the hash code of the text.
We will use the hash code to name the file.
Whenever the diagram changes, the file&amp;#8217;s name changes.
Also, if the file exists, it should contain the diagram for the current text.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To check that the file exists, we include it in the document.
Because we do not want the SVG text in the document, we surround the &lt;code&gt;include&lt;/code&gt; with the &lt;code&gt;block&lt;/code&gt; macro.
If the file does not exist, then an error will occur.
The macro &lt;code&gt;try&lt;/code&gt; will handle this error, and the execution will continue.
However, the macro &lt;code&gt;CREATE&lt;/code&gt; will be set to &lt;code&gt;true&lt;/code&gt; in this case.
If there is no error, when the file already exists, the macro &lt;code&gt;CREATE&lt;/code&gt; will be set to &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The &lt;code&gt;if&lt;/code&gt; macro will check the value of the macro &lt;code&gt;CREATE&lt;/code&gt;.
If it is &lt;code&gt;true&lt;/code&gt;, it will execute the &lt;code&gt;io:write&lt;/code&gt; and &lt;code&gt;io:exec&lt;/code&gt; macros to create the file.
If it is &lt;code&gt;false,&lt;/code&gt; then it will do nothing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-jamal&quot; data-lang=&quot;jamal&quot;&gt;{#define KEY={#hashCode {CHART}}}{@define CREATE=true}
{@try {#block{#include images/{KEY}.svg}}{@define CREATE=false}}
{#if `//`{CREATE}//
{#io:write (mkdir output=&quot;images/aaa.mmd&quot;) {CHART}}
{#io:exec command=&quot;&quot;&quot;mermaid
-i
images/aaa.mmd
-o
images/{KEY}.svg
&quot;&quot;&quot; cwd=&quot;.&quot; error=&quot;convert.err.txt&quot; output=&quot;convert.out.txt&quot;
}//}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For more details using these macros, please refer to the documentation.
If you intend to use multiple diagrams, you may want to create a macro that does all the steps above.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-summary-and-takeaway&quot;&gt;4. Summary and Takeaway&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article discussed integrating Mermaid diagrams into your Asciidoc, Markdown, or any other markup document.
We selected Mermaid for two reasons.
First, usually, this is the tool people ask for.
Second, this is an excellent example of a non-Java tool that can be integrated into document processing.
The described way can be applied to any external tool capable of running as a process.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The samples also demonstrate a complex structure of macros showing the power of the Jamal macro processor.
Such complexity is rarely needed.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In addition to the technology, I discussed, though only briefly, the separation of concerns for document handling and how the document formatting markup should be separated from the processing meta markup.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to have diagrams in your documentation, download Jamal, and start enhancing your documents.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author></entry><entry><title type="html">About the Questions on Linked In Java Developers Community</title><link href="https://javax0.github.io/2023/05/26/questions-on-linkedin.html" rel="alternate" type="text/html" title="About the Questions on Linked In Java Developers Community" /><published>2023-05-26T00:00:00+02:00</published><updated>2023-05-26T00:00:00+02:00</updated><id>https://javax0.github.io/2023/05/26/questions-on-linkedin</id><content type="html" xml:base="https://javax0.github.io/2023/05/26/questions-on-linkedin.html">&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article is a rant about the questions that are posted on the Linked In Java Developers Community.
I see many times questions that are not well formulated, and the answers are not well thought through.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is some good in it.
Being brave to go ahead and publish may be a good thing, but there is also some bad in it.
I face candidates during Java technical interviews many times giving &quot;typical&quot; wrong answers to some questions.
The source of that is the spread of these false and half, easy to misunderstand information.
One forum for them is LinkedIn Java Developers Community.
Presumably, there are other platforms.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What makes me really sad is that this community is moderated.
Still, questions of questionable quality are published.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;My aim with this article is to raise awareness in the vain hope that this will change.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-examples&quot;&gt;1. Examples&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In this section, I will display and discuss two examples.
After that I will write a few words of conclusion.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;1-1-example-1&quot;&gt;1.1. Example 1&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The very first question that I faced recently is the following:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;em&gt;Which one of the following loop cannot be used to change the value of any element in an array variable&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The While Loop&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The ForEach Loop&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The For Loop&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
A simple grammar checker could also help a bit, but that is not an issue worth mentioning.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/javax0/javax0.github.io/master/assets/images/linked-in-question-example-1.png&quot; alt=&quot;linked in question example 1&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I can understand the intention of the question.
The author really wanted to draw attention to the fact that a simple for-each loop cannot be used to modify the array elements it is looping through in a naive way.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.     void testForEachLoop0() {
2.         int[] array = {0, 0, 0, 0, 0, 0};
3.         for (int a : array) {
4.             a = 55; // does nothing
5.         }
6.         Assertions.assertArrayEquals(new int[]{0, 0, 0, 0, 0, 0}, array);
7.     }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As clearly demonstrated by the above example, when we loop over an array using a for-each loop, the loop variable is NOT the array element.
It is the value of the array element.
In the case of a primitive value, this is a copy of the value.
In the case of an object array, this is a copy of the reference to the object.
Which, indeed, in some sense is the copy of the value but not the copy of the object, rather the reference.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What we can do is to modify the object that the reference points to.
I can even say that if the value is an object (reference), then we can modify the object, hence the value.
For example,&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.     void testForEachLoop1() {
 2.         class X {
 3.             int value;
 4.
 5.             X(int value) {
 6.                 this.value = value;
 7.             }
 8.
 9.             @Override
10.             public boolean equals(Object o) {
11.                 return ((X) o).value == value;
12.             }
13.         }
14.         final var array = new X[]{new X(0), new X(0), new X(0)};
15.         for (final var a : array) {
16.             a.value = 55;
17.         }
18.         Assertions.assertArrayEquals(new X[]{new X(55), new X(55), new X(55)}, array);
19.     }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;will modify the field &lt;code&gt;value&lt;/code&gt; in the object array.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
Just for the shake of brevity I created an overly simplistic &lt;code&gt;equals&lt;/code&gt; method.
Don&amp;#8217;t do that in production code.
Don&amp;#8217;t do that even in test code.
Creating a &lt;code&gt;equals()&lt;/code&gt; method without a matching &lt;code&gt;hashCode()&lt;/code&gt; is a deadly sin.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can say that blaming the author on the language and the precision is nitpicking.
Do not forget, however, that these questions are targeting Java juniors, who can be confused by the imprecise language very easily.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And as a bonus, here is another example that modifies the original array.
If you look at it, you may realize that this is the same as the previous example, just overcomplicated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.     void testForEachLoop() {
2.         int[] array = {0, 0, 0, 0, 0, 0};
3.         for (int[] j : IntStream.range(0, array.length).mapToObj(i -&amp;gt; array).toArray(int[][]::new)) {
4.             j[j[0]] = j[0];
5.             j[0]++;
6.         }
7.         Assertions.assertArrayEquals(new int[]{6, 1, 2, 3, 4, 5}, array);
8.     }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;1-2-example-2&quot;&gt;1.2. Example 2&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The next question is the following:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;em&gt;What is the access modifier for an interface in Java?&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;public&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;private&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;protected&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;No modifier&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At least in this question, there is no grammar error.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/javax0/javax0.github.io/master/assets/images/linked-in-question-example-2.png&quot; alt=&quot;linked in question example 2&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Even if I do not know too much about Java, the question is fishy.
A modifier is something that modifies something.
Java is a well-designed language.
There is some clutter in it.
It could cut some things shorter, like writing &lt;code&gt;public static void&lt;/code&gt; in front of &lt;code&gt;main&lt;/code&gt; and decorating it with a whole class surrounding it.
However, if something is not needed, it is not there.
There is nothing like mandatory modifiers that you HAVE TO write.
There is no &quot;general and universal&quot; access modifier for an interface.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Some answers pointed out that an interface can be public, private, protected or package-private.
Not any of the interfaces though, because only nested interfaces can be private or protected, and only inside a class.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What the author wanted to ask, I assume, was the default visibility of the members in an interface.
That is public.
From the votes, as depicted below, it seems that three quarters of the people answered the question according to the intention of the author.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/javax0/javax0.github.io/master/assets/images/linked-in-question-example-3.png&quot; alt=&quot;linked in question example 3&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However, a significant number of people said that there is no need for a modifier, which is also true.
By default, the members are public, and for a long time in the history of Java that was the only option.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-conclusion&quot;&gt;2. Conclusion&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Asking questions is a good thing.
Usually, people ask questions because they want to learn.
StackOverflow is an excellent platform for that.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;These questions, however, more like exams.
Professors ask such questions.
It is a profession.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To ask an &quot;exam&quot; question, you have to be an expert in the field.
But that is not enough.
You also have to be precise and know what and how to ask.
You have to understand what the readers will learn from your question.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I feel that many of these authors evaluate this latter assuming that all the readers will read the questions and also the answers.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First of all: there is no answer.
People vote and hardly ever go back when the voting finishes.
The answer is simply the result, but no explanation for the details.
The explanation is in the comments.
Many times there are some good comments but also many misleading.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It reminds me of a Peter Bruegel painting from 1568, &quot;The Blind Leading the Blind&quot;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/%D0%9F%D1%80%D0%B8%D1%82%D1%87%D0%B0_%D0%BE_%D1%81%D0%BB%D0%B5%D0%BF%D1%8B%D1%85.jpeg/2560px-%D0%9F%D1%80%D0%B8%D1%82%D1%87%D0%B0_%D0%BE_%D1%81%D0%BB%D0%B5%D0%BF%D1%8B%D1%85.jpeg&quot; alt=&quot;2560px %D0%9F%D1%80%D0%B8%D1%82%D1%87%D0%B0 %D0%BE %D1%81%D0%BB%D0%B5%D0%BF%D1%8B%D1%85&quot; width=&quot;600&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to ask a question: do it.
However, do it right.
Before publishing it for thousands of people, ask a few friends to read it.
If more than one misunderstands it, then you have to rephrase it.
If some of them give a wrong answer and then seeing the right one, they start to argue about the question and the correctness: the question is wrong.
You may believe that they are wrong and not the question, but you cannot change your audience.
You can change your question.
Your question can hypothetically be correct, but wrong for the given audience.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">This article is a rant about the questions that are posted on the Linked In Java Developers Community. I see many times questions that are not well formulated, and the answers are not well thought through.</summary></entry><entry><title type="html">Rearrange and array in place</title><link href="https://javax0.github.io/2023/05/24/inplace-rearrange.html" rel="alternate" type="text/html" title="Rearrange and array in place" /><published>2023-05-24T00:00:00+02:00</published><updated>2023-05-24T00:00:00+02:00</updated><id>https://javax0.github.io/2023/05/24/inplace-rearrange</id><content type="html" xml:base="https://javax0.github.io/2023/05/24/inplace-rearrange.html">&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article is about an algorithmic problem.
I did not find a solution to this problem either thinking about it, searching the net or talking to friends.
The problem itself is simple.
At the first reading, it may lure the reader into a false sense of simplicity.
You may feel that this should not be an issue.
But it is.
At least for me.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Nothing Java.
Nothing programming other than it is about an algorithmic problem.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-problem-statement&quot;&gt;1. Problem Statement&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is an array of \(2n\) elements.
The array is \(A=\{a_1,a_2, ... , a_n, b_1, b_2, ... , b_b\}\).
What steps should be taken to rearrange the array so that \(A=\{a_1,b_1,a_2,b_2, ... , a_n,b_n\}\) with limited, maximum \(O(1)\) memory, and \(O(n)\) time.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-chatgpt-solution&quot;&gt;2. ChatGPT solution&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Sine generative AI is sweeping the media and the internet; I thought that I should try to use it to solve the problem.
After all, if it takes my job just in a few years, at least we can let it do some work for us till then.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Here is the answer, no surprise: totally wrong:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock warning&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Warning&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Wrong answer from ChapGPT&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To rearrange the array \(A=\{a_1,a_2, ... , a_n, b_1, b_2, ... , b_n\}\) into \(A=\{a_1,b_1,a_2,b_2, ... , a_n,b_n\}\) with limited, maximum O(1) memory, and \(O(n)\) time you can follow the steps below:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Traverse the array and for each element at index \(i\), swap it with the element at index \(i+n\).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;literalblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre&gt;For i=1 to n:
  Swap A[i] with A[i+n]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After the traversal is complete, the array will be rearranged as \(A=\{a_1,b_1,a_2,b_2, ... , a_n,b_n\}\).
The above algorithm has a time complexity of O(n) and uses only O(1) memory as only a constant number of variables are used for swapping elements in the array.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After following these steps, the original array \(A=\{a_1,a_2, ... , a_n, b_1, b_2, ... , b_n\}\) would be rearranged as \(A=\{a_1,b_1,a_2,b_2, ... , a_n,b_n\}\).&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The described algorithm is \(O(n)\) time and \(O(1)\) memory, but the resulting array will be \(A=\{b_1,b_2, ... , b_n,a_1,a_2, ... , a_n\}\).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
I am not worried about being replaced by an AI as a software engineer. Yet.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-without-the-o1memory-constraint&quot;&gt;3. Without the \( O(1)\)memory constraint&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The problem is not that hard if you do not have the \(O(1)\) memory constraint.
As a matter of fact it is so easy that it can be solved even by ChapGPT.
Or can it?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Simpler problem, still not good answer from ChapGPT&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To rearrange the array \(A={a_1,a_2, ... , a_n, b_1, b_2, ... , b_n}\) into \(A={a_1,b_1,a_2,b_2, ... , a_n,b_n}\), you can follow the steps below:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Create two new arrays, one for the \(a\) values and another for the \(b\) values.
Initialize an empty array for the \(a\) values, say \(a_{new}\).
Initialize an empty array for the \(b\) values, say \(b_{new}\).
Traverse the original array and separate the \(a\) and \(b\) values into two separate arrays.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;For i=1 to n:&lt;/code&gt;&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Add&lt;/code&gt; \(a_i\) &lt;code&gt;to&lt;/code&gt; \(a_{new}\)&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Add&lt;/code&gt; \(b_i\) &lt;code&gt;to&lt;/code&gt; \(b_{new}\)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;For i=n+1 to 2n:&lt;/code&gt;&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Add&lt;/code&gt; \(b_i\) &lt;code&gt;to&lt;/code&gt; \(a_{new}\)&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Add&lt;/code&gt; \(a_i\) &lt;code&gt;to&lt;/code&gt; \(b_{new}\)&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Concatenate the two new arrays in the desired order to get the final result.
Concatenate \(a_{new}\) and \(b_{new}\) in the order \(a_{new}, b_{new}\) to get the desired result.
After following these steps, the original array \(A={a_1,a_2, ... , a_n, b_1, b_2, ... , b_n}\) would be rearranged as \(A={a_1,b_1,a_2,b_2, ... , a_n,b_n}\).&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I believe there is no need to explain why the solution is wrong, and overly complicated.
The allocation of the two arrays is unnecessary.
We need only one extra array of length \(2n\), say \(T\).
Then the code will look:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;For i=1 to n:&lt;/code&gt;&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Add&lt;/code&gt; \(a_i\) &lt;code&gt;to&lt;/code&gt; \(T\)&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Add&lt;/code&gt; \(b_i\) &lt;code&gt;to&lt;/code&gt; \(T\)&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Voil, you have the result in \(T\).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
Still not worried.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-without-the-on-time-constraint-on2&quot;&gt;4. Without the \( O(n)\) time constraint: \(O(n^2)\)&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;How about giving some extra time instead of extra memory?
Let&amp;#8217;s keep the \(O(1)\) memory constraint, but allow \(O(n^2)\) time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This problem is also simple to solve, but for some reason, ChatGPT gave such a foolish answer that I decided not to copy here.
I know, you are curious, but it has no value, totally gibberish.
The solution is&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;to take \(b_i\)out from the array for every \(i=1,n\)one by one,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;push every element one position higher below \(b_i\) until we get to the place where \(b_i\) will get&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;put \(b_i\) to its place.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock text-center&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://raw.githubusercontent.com/javax0/javax0.github.io/master/assets/images/insert-rearrange.png&quot; alt=&quot;insert rearrange&quot; width=&quot;50%&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;For i=1 to n:&lt;/code&gt;&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Store&lt;/code&gt; \(b_i\) &lt;code&gt;being at the position&lt;/code&gt; \( n+i\)&lt;code&gt;to a variable named&lt;/code&gt; \(x\)&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Move all objects from&lt;/code&gt; \( 2i\) &lt;code&gt;till&lt;/code&gt; \(n+i\) &lt;code&gt;to the next position&lt;/code&gt;&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Put &lt;/code&gt; \(b_i\)&lt;code&gt;from the variable&lt;/code&gt; \(x\)&lt;code&gt;to the position 2i&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;During the first step, we have to move \(n-1\) objects.
During the second step, we have to move \(n-2\) objects, and so on.
Moving all the \(b_i; i=1,n\)elements will need \( \sum_{i=1}^{n-1} (n-i) = \frac{n(n-1)}{2}\) moves.
It means that this algorithm is \(O(n^2)\) time.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;5-without-the-on-time-constraint-on-log-n&quot;&gt;5. Without the \( O(n)\) time constraint: \(O(n \log n)\)&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We know that there is a faster, more complex solution that is \(O(n \log n)\) time.
Let&amp;#8217;s have a look at that:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If the array length is 2, in other words, the array is \(A=\{a_1,b_1\}\), then the solution is trivial.
In that case do not need to do anything, just return the array as it is.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Funny (wrong) suggestion from CoPilot&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;em&gt;If the array is longer, then we can split it into two parts, rearrange them separately, and then merge the results.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The above sentence is not part of the normal flow of this article.
I write this article with CoPilot switched on.
The above sentence was suggested by CoPilot for this location.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is fun to write articles with CoPilot switched on (pronounce it as Copy-a-Lot).
I do not say it is easier, or less work.
Sometimes it feels like a little kid running around and making a mess while you try to clean your flat.
Rather the contrary, but undeniably &lt;em&gt;more fun.&lt;/em&gt;
Cursive words in the above paragraphs all were suggested by CoPilot.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And now, just let&amp;#8217;s go on with the normal text of the article.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Assume that the array length is \(n=2^m\).
Divide the array into four parts:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;\(Q_1=[a_1-a_\frac n2\)],&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;\(Q_2=[a_{\frac n2+1},a_n\)],&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;\(Q_3=[b_1-b_\frac n2\)],&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;\(Q_4=[b_{\frac n2+1},b_n\)],&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Swap the elements of \(Q_2\) and \(Q_3\)in a single loop:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;For i=1 to &lt;/code&gt; \( \frac n2\)&lt;code&gt;:&lt;/code&gt;&lt;br&gt;
&lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt; &lt;/code&gt; &lt;code&gt;Swap&lt;/code&gt; \(a_{\frac n2+i}\) &lt;code&gt;and&lt;/code&gt; \(b_i\)&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Essentially, we transform the array \(Q_1|Q_2|Q_3|Q_4\) into \(Q_1|Q_3|Q_2|Q_4\).
After this, the algorithm can be applied for the sub arrays \(Q_1|Q_3\) and \(Q_1|Q_4\).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The assumption that \(n=2^m\) helps to halve the array down to length 2.
When the length of the array is not some power of two, the halving is not trivial.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The algorithm running time \(T(n) = 2T(\frac n2) + O(n)\).
The \(O(n)\)term is the time needed to swap the elements of \(Q_2\)and \(Q_3\).
The resulting time complexity is \(O(n \log n)\).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;6-conclusion-and-takeaway&quot;&gt;6. Conclusion, and Takeaway&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I shared this &quot;simple&quot; algorithmic problem with you.
It is haunting me for a few years.
The beauty of this problem is that it is simple, but not trivial.
If you happen to know the answer, tell me!
I am old enough accepting my limits, and it will more amaze me to see the solution than angry about wy I have not seen it before.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;title&quot;&gt;CoPilot&amp;#8217;s suggestion&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;em&gt;The takeaway is that you should not be afraid of simple problems.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;How about AI?
What is the merit of all this?
Should we be afraid of AI?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The answer is no.
There is no point of being afraid, generally.
We can be prepared, aware, but not afraid.
AI in its current form can help us solve problems, but it is immature.
I expect the change and maturing of AI will be extremely rapid to a point.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It will transform how we work, but will not work instead of us or replace us.
Some people will lose jobs, but new jobs will be created.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the 1950s, people were afraid of computers.
As a matter of fact, the women doing the numerical calculations were called computers.
Their job does not exist today, but it did not disappear from day one to the next.
It took years to disappear.
We still do some calculations by hand.
We still use calculators on the job site.
There is even an anachronistic calculator app on the iPhone.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Something similar will happen with AI.
The change will be gradual.
We will have time to adapt.
AI development is fast, and we feel that the development of new technologies speeds up.
However, this speed is limited by the adoption rate of humans.
Humans do not change that fast.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">This article is about an algorithmic problem. I did not find a solution to this problem either thinking about it, searching the net or talking to friends. The problem itself is simple. At the first reading, it may lure the reader into a false sense of simplicity. You may feel that this should not be an issue. But it is. At least for me.</summary></entry><entry><title type="html">Converting Numbers to Roman Numerals</title><link href="https://javax0.github.io/2023/05/23/converting-to-roman-numerals.html" rel="alternate" type="text/html" title="Converting Numbers to Roman Numerals" /><published>2023-05-23T00:00:00+02:00</published><updated>2023-05-23T00:00:00+02:00</updated><id>https://javax0.github.io/2023/05/23/converting-to-roman-numerals</id><content type="html" xml:base="https://javax0.github.io/2023/05/23/converting-to-roman-numerals.html">&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Article Management Technical Details&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Code &lt;a href=&quot;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-05-23-converting-to-roman-numerals&quot;&gt;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-05-23-converting-to-roman-numerals&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Article source &lt;a href=&quot;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-05-23-converting-to-roman-numerals.adoc.jam&quot;&gt;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-05-23-converting-to-roman-numerals.adoc.jam&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article will look at some Java code that converts a number to Roman numerals.
We will look at different solutions and compare them.
You can read this article as a mental exercise, like a coding kata, but at the same time, we also discuss some coding styles.
If you like to use big words, we can say it is about code architecture.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-the-problem&quot;&gt;1. The Problem&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We have a number and want to convert it to Roman numerals.
Roman numerals are the numbers that we used in the Roman Empire.
They remained in use for a long time and are still used in some places.
A typical example is the face of some watches.
They denoted the numbers with letters.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The value of 1 was denoted with the letter &lt;code&gt;I&lt;/code&gt;, five was denoted with the letter &lt;code&gt;V&lt;/code&gt;, ten was denoted with the letter &lt;code&gt;X&lt;/code&gt;, and so on.
It is a kind of decimal notation with some additions.
The decimals are denoted by different symbols, namely &lt;code&gt;I&lt;/code&gt;, &lt;code&gt;X&lt;/code&gt;, &lt;code&gt;C&lt;/code&gt;, and &lt;code&gt;M&lt;/code&gt;, and not the position.
Additionally, there are symbols for 5, 50, and 500, namely &lt;code&gt;V&lt;/code&gt;, &lt;code&gt;L&lt;/code&gt;, and &lt;code&gt;D&lt;/code&gt;.
1, 2, and 3 are denoted by repeating the symbol &lt;code&gt;I&lt;/code&gt;, so they are &lt;code&gt;I&lt;/code&gt;, &lt;code&gt;II&lt;/code&gt;, and &lt;code&gt;III&lt;/code&gt;.
Similarly, 10, 20, and 30 are denoted as &lt;code&gt;X&lt;/code&gt;, &lt;code&gt;XX&lt;/code&gt; and &lt;code&gt;XXX&lt;/code&gt;, and so on.
A letter does not repeat more than three times in a row.
There are some exceptions in some watches, but that is an exception and not the rule.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you need 4, you take the symbol for five and subtract the symbol for 1, so 4 is &lt;code&gt;IV&lt;/code&gt;.
The subtraction is denoted by placing the &lt;code&gt;I&lt;/code&gt; before the &lt;code&gt;V&lt;/code&gt;.
5, 6, 7, and 8 are denoted as &lt;code&gt;VI&lt;/code&gt;, &lt;code&gt;VII&lt;/code&gt;, and &lt;code&gt;VIII&lt;/code&gt;.
Again 9 Would require four &lt;code&gt;I&lt;/code&gt; characters, but that is not allowed.
Nine is denoted as &lt;code&gt;IX&lt;/code&gt;, where the &lt;code&gt;I&lt;/code&gt; is before the &lt;code&gt;X&lt;/code&gt;; again a subtraction.
The same logic applies to the other symbols.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-solution-approach&quot;&gt;2. Solution approach&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-1-interface&quot;&gt;2.1. Interface&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For the solution, we will have an interface.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1. public interface Romans {
 2.     String toRoman(int value);
 3.
 4.     static final int I = 1;
 5.     static final int II = 2;
 6.     static final int III = 3;
 7.     static final int V = 5;
 8.     static final int M = 1000;
 9.     static final int nulla = 0;
10.
11.     static void assertRange(int value) {
12.         if (value &amp;lt; 1 || value &amp;gt; 3999) {
13.             throw new IllegalArgumentException(&quot;Counter &apos;%s&apos; grew too big to be formatted as a roman numeral&quot;.formatted(value));
14.         }
15.     }
16. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The critical part is the &lt;code&gt;toRomans()&lt;/code&gt; method.
We will implement it in three different ways and compare the different approaches.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-2-test&quot;&gt;2.2. Test&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Professional implementation does not exist without tests.
The tests are straightforward:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.     @Test
 2.     @DisplayName(&quot;Unitas testis pro minimo numeri converters&quot;)
 3.     void testTrivial() {
 4.         testRomanFormatAll(new RomansTrivial());
 5.     }
 6.
 7.     @Test
 8.     @DisplayName(&quot;Unitas testis pro simplici numeri converters&quot;)
 9.     void testSimple() {
10.         testRomanFormatAll(new RomansSimple());
11.     }
12.
13.     @Test
14.     @DisplayName(&quot;Unitas testis pro complexu numeri converters&quot;)
15.     void testComplex() {
16.         testRomanFormatAll(new RomansComplex());
17.     }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The actual method that does the testing calls the converter for all possible values:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.     private void testRomanFormatAll(Romans r) {
 2.         final StringBuilder sb = new StringBuilder();
 3.         for (int i = 1; i &amp;lt; 4000; i++) {
 4.             sb.append(i).append(&apos;=&apos;).append(r.toRoman(i)).append(&apos;\n&apos;);
 5.         }
 6.         Assertions.assertEquals(
 7.                 //&amp;lt;editor-fold desc=&quot;omnibus romanis numeris ab I = I ad MMMXCIX&quot;&amp;gt;
 8.                 &quot;&quot;&quot;
 9. 1=I
10. 2=II
11. 3=III
4008. &quot;&quot;&quot;
4009.                 //&amp;lt;/editor-fold&amp;gt;
4010.                 , sb.toString());
4011.     }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
As you can see from the line numbering, we have omitted some lines from the output.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-3-trivial-solution&quot;&gt;2.3. Trivial Solution&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since we have all the roman numerals in a string, the lazy and most straightforward solution is to put them into an array and use indexing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1. public class RomansTrivial implements Romans {
 2.
 3.     private static final String[] ROMANS = {
 4.             //&amp;lt;editor-fold desc=&quot;omnibus romanis numeris a I = i ad MMMCMXCIX in linea ordinata&quot;&amp;gt;
 5.             &quot;I&quot;,
 6.             &quot;II&quot;,
 7.             &quot;III&quot;,
 8.             &quot;IV&quot;,
4001.             &quot;MMMCMXCVII&quot;,
4002.             &quot;MMMCMXCVIII&quot;,
4003.             &quot;MMMCMXCIX&quot;
4004.             //&amp;lt;/editor-fold&amp;gt;
4005.     };
4006.
4007.     public String toRoman(int value) {
4008.         Romans.assertRange(value);
4009.         return ROMANS[value - I];
4010.     }
4011. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
Again, we have omitted some lines from the output.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The following approach is to be a bit more complex.
Storing 3999 numbers in an array may be simple, but somehow, it is not elegant.
We are programmers, solving problems with algorithms and not simply listing all the results.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-4-simple-solution&quot;&gt;2.4. Simple Solution&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The more complex approach still uses a string array.
After all, the selection of the letters representing Roman numerals was arbitrary at the time.
The Roman scholars did not consult their 2000 years descendants to find out the best way to represent the numbers aligning with modern computer technology like ASCII codes and Unicode.
We have to list the numbers and the corresponding Roman numerals in the same order, either in a data structure or the code.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1. public class RomansSimple implements Romans {
 2.     int [] places = {1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1};
 3.     String [] numerals = {&quot;M&quot;, &quot;CM&quot;, &quot;D&quot;, &quot;CD&quot;, &quot;C&quot;, &quot;XC&quot;, &quot;L&quot;, &quot;XL&quot;, &quot;X&quot;, &quot;IX&quot;, &quot;V&quot;, &quot;IV&quot;, &quot;I&quot;};
 4.
 5.     public String toRoman(int value) {
 6.         Romans.assertRange(value);
 7.         final var s = new StringBuilder();
 8.         for( int j = 0; j &amp;lt; places.length; j++ ) {
 9.             while( value &amp;gt;= places[j] ) {
10.                 s.append(numerals[j]);
11.                 value -= places[j];
12.             }
13.         }
14.         return s.toString();
15.     }
16. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We look at the number; if it is larger than 1000, it will start with &lt;code&gt;M&lt;/code&gt;.
If it is larger than 3000, it will start with &lt;code&gt;MMM&lt;/code&gt;; if it is larger than 2000, it will start with &lt;code&gt;MM&lt;/code&gt;; and if it is larger than 1000, it will start with one &lt;code&gt;M&lt;/code&gt;.
Roman numerals are the sum of the letters, except for the subtraction rule.
However, we can look at &lt;code&gt;CM&lt;/code&gt;, &lt;code&gt;CD&lt;/code&gt;, &lt;code&gt;XC&lt;/code&gt;, &lt;code&gt;XL&lt;/code&gt;, &lt;code&gt;IX&lt;/code&gt;, and &lt;code&gt;IV&lt;/code&gt; as individual symbols.
They are two letters, but the algorithm never relies on the fact that the other values are represented with single letters.
That way, we can go on with all elements, from large to smaller ones.
When the value is larger than the actual number, we add the symbol to the output string and remove the number from the value.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I suspect that this is the solution that fits most of the developers.
Simple and does not require the excessive list of the roman numerals.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-5-complex-solution&quot;&gt;2.5. Complex Solution&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;A real developer, however, does not like a solution that implements logic in the data structure.
The rule that a symbol representing a smaller number than the subsequent one is subtracted from the subsequent one is something that can be programmed.
It does not need a data structure.
The data structure is redundant, and any redundancy in the code is against maintainability.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Or not.
Mind my words; we will revisit it in the following main section.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The code for the solution that does not use an excessive data structure is the following:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1. public class RomansComplex implements Romans {
 2.     private static final char[] NUMERI = {&apos;M&apos;, &apos;D&apos;, &apos;C&apos;, &apos;L&apos;, &apos;X&apos;, &apos;V&apos;, &apos;I&apos;};
 3.
 4.     /**
 5.      * Haec methodus datam rationem ad numeros Romanos convertit. Modulus &quot;id&quot; solum nuntium errorem componere pro casu
 6.      * cum numerus affirmativus vel nimius non est.
 7.      * Hunc codicem legamus in honorem Octaviani imperatoris nostri, qui numerum octonarium induxit.
 8.      *
 9.      * @param valorem ad valorem convertendi
10.      * @return Romano numero quasi filum
11.      */
12.     public String toRoman(int valorem) {
13.         Romans.assertRange(valorem);
14.         var lineaAedificator = new StringBuilder();
15.         int numeralis = M;
16.         int inclinatio = nulla;
17.         for (int j = nulla; j &amp;lt; NUMERI.length; j++) {
18.             while (valorem &amp;gt;= numeralis) {
19.                 lineaAedificator.append(NUMERI[j]);
20.                 valorem -= numeralis;
21.             }
22.             final var compensatio = II - inclinatio;
23.             final var decimales = numeralis / (V * compensatio);
24.             if (valorem &amp;gt;= numeralis - decimales) {
25.                 lineaAedificator.append(NUMERI[j + compensatio]).append(NUMERI[j]);
26.                 valorem -= numeralis - decimales;
27.             }
28.             numeralis /= II + III * inclinatio;
29.             inclinatio = I - inclinatio;
30.         }
31.         return lineaAedificator.toString();
32.     }
33. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is a real geek implementation with a minimal data structure and all logic in the code.
The source of this was a stone tablet found in the ruins of the ancient Roman Empire.
As such, it can be treated as a reference implementation, and it does not need explanation.
The code is evident.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-selecting-a-solution&quot;&gt;3. Selecting a Solution&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We have seen three different solutions.
Two were extreme in pushing the scale from minimal code maximum data to maximum code minimum data.
The simple solution was a solution in the middle of the scale.
Which one should we use in a professional application?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now, think about it, and have an opinion.
When you have that, then think about the reason.
Why would you select that solution?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now read on.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When we create a professional solution, we usually follow engineering practices.
One of these is to avoid code redundancy.
But at the same time, we also hate data redundancy.
The reason is that any redundancy in the code or data is a potential source of errors.
In the case of code, we call these errors bugs.
In the case of data, we call these errors data errors or data corruption.
We do not like either of them.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I do not want to be rude, but who cares what we like or hate?
The client certainly does not.
What matters is client satisfaction.
What the client cares about in a business environment is money.
In this case, the money they spend on the solution and the money they gain using the software.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Let&amp;#8217;s have a look at it for this specific example.
It may seem intriguing, and it is.
The example is too simple to be a real-world problem.
However, this simplicity makes it pure and a prime and hopefully entertaining example for the demonstration.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Is there any difference in what the client can earn depending on the solution we choose?
In this case, barely.
The speed may be a differentiating factor.
Functionality is not.
Functionality is the same in all three cases.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When one solution is significantly faster than the other, then it should be considered.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But what is significant in this case?
Is 10% significant?
Or a 100 times speed up?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-1-speed-difference&quot;&gt;3.1. Speed Difference&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The speed difference is significant if the client can earn more money with the faster solution.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;3-1-1-execution-speed&quot;&gt;3.1.1. Execution Speed&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The client uses a server application starting once every month once.
The startup of the application takes 1 second.
We can invest some effort to speed up this startup time to be under 10ms.
It probably does not matter.
This 100 times speed up is not significant.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The client uses an application that does a geology calculation.
The geo engineer uses the result, and based on that, he starts a new calculation.
In this iterative way, he finds the optimal solution for &amp;#8230;&amp;#8203; whatever.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The calculation takes 8 hours and 30 minutes.
They start it every time before going home, and they have the result the next morning.
This way, they can do one iteration per day.
They are very strict about not doing overtime or overwork.
They are not German.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Optimizing the application and speeding it up 10% so that it finishes in 7 hours and 39 minutes does not seem, at first sight, to be significant.
However, such a speed-up means the geo-engineer can do two iterations daily.
Starting one in the morning, looking at the result, and starting the next one in the afternoon before they leave for their &lt;em&gt;repas du soir&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The bottom line is the money, precisely the client&amp;#8217;s money.
In the example of converting numbers to roman numerals, it is hard to say without knowing the specific business application in which one creates more money for the client.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;3-1-2-development-speed&quot;&gt;3.1.2. Development Speed&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The other speed difference is the speed of development.
It is significant if one solution can be finished sooner and can start earning money for the client.
The money the client gains this way has to be put into the equation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Many years ago, I was working on a project where the client was managing debts.
The company got a CSV file of 10,000 debtors.
The people were calling them, texting them, writing emails, and so on.
Every contact was recorded into the Excell file.
At the end of the month, they sent the csv, including the transactions, back to the lenders&apos; aggregator.
The following month they started with 10,000 different debtors.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The company&amp;#8217;s added value was the knowledge of how to convince the debtors to pay.
I had known the owners for a long time; I knew they did not do anything illegal or unethical.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;One day the aggregator asked them if they could scale up to handle 100,000 debtors every month.
They could hire more people, but that amount of records was already beyond the technical capability of the Excel-based solution.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;They asked for a quote to create an application to handle the 100,000 debtors.
There were two offers.
My company, which I had back in 2007, offered a solution based on Jira with plugins.
We guaranteed to deliver a working version for the import in two weeks, and at the end of the first month, the version capable of exporting.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The other company offered a solution developed from scratch using Delphi.
Their development time was six months.
The significant advantage of their proposed solution was that it was to be fine-tuned for the specific business application.
Calling one client after the other, the administrator did not need to click three or more times from one issue to the other, like in the case of a Jira-based solution.
It was explained as a click, click, enter, done workflow.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The client ordered both solutions.
We delivered in two weeks and finished a rudimentary but usable working solution in six weeks.
They used this solution for the next 13 months until the other solution became ready.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The bottom line is the money, specifically the client&amp;#8217;s money.
In converting numbers to roman numerals, the trivial solution was five minutes, including the unit tests.
The simple solution was 30 minutes.
The complex solution was 2 hours, except it was already available since the Roman ages; we just had to copy the characters from the stone tablet.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;3-1-3-development-speed-again&quot;&gt;3.1.3. Development Speed Again&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The development speed is critical not only for the client but also for the developer.
The more time you spend developing a feature, the more your cost is.
The client pays for the feature, but the developer pays for the time spent.
The market determines the price and is only vaguely coupled with the cost.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is already the cost side of the equation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;3-1-4-maintenance&quot;&gt;3.1.4. Maintenance&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The following cost factor is the cost of maintenance.
Developing an application is not the end of the story.
The application has to be maintained.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The requirements of the client may change in the future.
The market and environment change and the client must respond to these business changes.
It will require a change in the application.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There may be bugs in the application discovered only after the application is in production.
These also need a change in the application.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the case of bugs, it is evident that the maintenance cost is the developer&amp;#8217;s burden.
In the case of new features, it is not so evident, but it is.
Just as in the case of the original development, the client pays for the feature.
They do not care and do not even know what the cost of the development is.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The development cost is discussed with the client often during the sales negotiation.
It, however, is a sales issue.
The client wants to pay the lowest price, and the salesperson wants to sell the highest.
Neither is interested; however, pushing the price to a range will make the other party stand up from the table and leave now or in the future.
That is why the costs are mentioned at all.
It is all sales negotiation.
The cost is on the production side.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Look at the three examples:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;the trivial solution with a vast data set,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;the simple solution with a small set, and&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;the complex solution with a non-redundant data set.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You have to estimate the cost of the maintenance of the different parts.
What is the probability that a discovered bug or a new feature will need a code change or data change?
What is the cost of such a change?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The fun in this example is that there is barely any imaginable possibility for a change request.
Roman numerals have been with us for thousands of years, they are literally carved in stone.
They are not going to change.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I selected this example not only because it was a coding kata a few days ago at the company where I work but also because recently, I had a change request in one of my open-source projects.
Jamal, you can reach &lt;a href=&quot;https://github.com/verhas/jamal&quot; class=&quot;bare&quot;&gt;https://github.com/verhas/jamal&lt;/a&gt;, has a counter that can format the counter value as roman numerals.
Created, done, tested, and released a few years back.
What change could you imagine?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Well, I could not imagine any, either.
Until someone asked me if it would be possible to format the counter value as &lt;code&gt;IIII&lt;/code&gt; for four.
It is an alternate format for &lt;code&gt;IV&lt;/code&gt; in some cases.
I remember my grandmother had a clock with roman numerals, with &lt;code&gt;IIII&lt;/code&gt; for four.
It was hand-painted.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-summary&quot;&gt;4. Summary&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We had a little fun with the Roman numerals.
Do not take all the sentences in this article as facts, especially not the ones written in Latin.
Or about the Latins.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We discussed code and data complexity a bit, though I mainly left it to your imagination.
What we discussed, however, is the base of any professional development decision.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We follow object-oriented programming principles.
We do functional programming.
We avoid copy-paste.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Why?
Because, in most cases, it is the right thing to do.
Because, in most cases, it is the practice that will result in the lowest cost for us.
Because in most of the cases&amp;#8230;&amp;#8203;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The emphasis in this article is on the &lt;em&gt;&quot;in most of the cases&quot;&lt;/em&gt; part.
There can be exceptions, and as a true professional, you have to be able to recognize them.
There is only one single thing that you MUST NOT do: use this article as an excuse for wanting to be lazy.
It is not about that.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author></entry><entry><title type="html">About Rust</title><link href="https://javax0.github.io/2023/02/13/about-rust.html" rel="alternate" type="text/html" title="About Rust" /><published>2023-02-13T00:00:00+01:00</published><updated>2023-02-13T00:00:00+01:00</updated><id>https://javax0.github.io/2023/02/13/about-rust</id><content type="html" xml:base="https://javax0.github.io/2023/02/13/about-rust.html">&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article is for developers and managers who have heard about Rust but do not know much about it.
It is not a tutorial.
I write what I see and give some unsolicited&amp;#8201;&amp;#8212;&amp;#8201;or assuming you read it not by accident, then solicited&amp;#8201;&amp;#8212;&amp;#8201;advice.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-introduction&quot;&gt;1. Introduction&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article is a few words about Rust.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust is a ten-year-old programming language.
In my opinion this language will shape the industry in the future comparable to the impact of Java.
Time will tell.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;New programming languages arise all the time, and then they get forgotten.
I remember when Roger Lang told me in 1997 about Java that it was a paper tiger.
We worked for Digital Equipment Corporation in the Hungarian subsidiary, and Java was relatively new.
The expression &quot;paper tiger&quot; references the Chinese proverb, &quot;The tiger that is paper is not a tiger&quot;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;He failed.&lt;br&gt;
Java did not.&lt;br&gt;
Java was a tiger, though an infant.&lt;br&gt;
Some believed it even then, but nobody could &quot;know&quot;.&lt;br&gt;
The future of Java was not sure.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The same is with Rust now.&lt;br&gt;
Although it is a ten-year-old language, it is still an infant.&lt;br&gt;
Technically it is not.
There are many solutions in the language and in the whole infrastructure architecture that are mature and brilliant.
What is still missing is community and industry acceptance.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;My prediction is that&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust will step over the industry acceptance threshold in 2023, becoming a player in the industry; you can be confident it will not fade and be forgotten soon.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Before going on with the rest of the article, I have to make a statement:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;exampleblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am not a Rust expert. I have recently started learning the language and am still a beginner.
I have written more than a simple &quot;Hello,World!&quot; but that is it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On the other hand, I have more than 40 years of programming experience if we start counting from my first program line, which was executed by a processor (TI-59 calculator) in 1980.
I programmed in FORTRAN, BASIC, Pascal, C, C++, Java, JavaScript, Python, and many other languages.
Java, as you can see from the topic of the blog, is my main charter for now.
May Rust be the future.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In this article, I will write a few words about Rust.
I will not teach you Rust.
(After the disclaimer, this should be evident.)
I will write down some of the features that I felt were important and interesting.
I try to focus on the essential features from the commercial point of view.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The reason is that they are the features that will make Rust a success or a failure.
You, as a developer, may like some features.
You may say, &quot;how cool Rust is because of&quot; this or that feature.
But if the feature is not essential for the industry, or the managers, then it is not crucial for Rust.
A language is not a hobby project.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article is about what I have seen so far and what I imply from it for the future of the language.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-rust-is-a-systems-programming-language&quot;&gt;2. Rust is a systems programming language&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Being a Java developer, I do not feel threatened by Rust.
Rust is a system programming language like C or C++.
It is a robust language, and I believe writing enterprise applications in it is possible, but not now.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust compiles to machine code or WebAssembly.
There is no virtual machine and no garbage collection.
It means that the performance is comparable to C and C.
I would not write it is faster than Java because even C and C are slower than Java in some particular cases.
The important thing is that there are no hiccups in the performance during garbage collection.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I acknowledge that Java has dramatically improved and has a highly optimized garbage collector.
Still, it collects the garbage and then releases it in batches, affecting performance.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Google&amp;#8217;s Golang garbage collector is also fast.
However, comparing it to any other GC, you should remember that it does not compact the heap.
It simply can not because the language uses pointers, and as such, it is prone to memory fragmentation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;By the way: using pointers also makes Rust prone to this problem.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-memory-safety&quot;&gt;3. Memory Safety&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is a technical section in this article.
If you are a manager and impatient, here it is in one sentence:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust uses a memory management approach, which delivers the same level of safety as Java without the garbage collection overhead.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;(Managers can skip to the next section.)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Memory safety is the feature that makes Rust outstanding and unique.
C trusts the developer not to make mistakes.
It is a wrong choice.
Developers make mistakes, Rust does not.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Developers have to know when the code is not using an allocated memory chunk anymore, and they have to free it.
This is something that a compiler could do.
In principle, a compiler could identify the memory chunks not used anymore and generate code to free them.
They don&amp;#8217;t do that because the task is computationally expensive.
In short, the compiler cannot identify when to free the memory.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On the other end of the scale, Java safeguards everything using the garbage collector.
In this case, the run-time keeps track of all the references and frees the memory when it is not referenced anymore.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust language developers did not accept the statement that the compiler could not do it.
They approached the problem again, and they found a solution.
The solution is called &quot;ownership&quot;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The reference to a memory location is either owning the resource or borrowing it.
There can be only one resource owner, just like in real life.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At first, it is a bit hard to grasp the concept and needs a bit of different thinking than C or Java development.
However, it is a brilliant solution.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-application-management&quot;&gt;4. Application Management&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust does not have built-in application management.
The reason for it is that Rust is a systems programming language.
When you have a JVM process, you can attach a debugger, query the memory and thread parameters, and make a memory dump.
With Rust, all you can do is what the operating system lets you do.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you run an enterprise application that runs for several months between two maintenance stops for the ubiquitous version update, you need information about the running system to know how well it performs.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust may have and certainly will have libraries and tools in the future addressing this issue, but it is not part of the ecosystem and the default run-time.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;5-ease-of-learning&quot;&gt;5. Ease of Learning&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is a critical point.
Rust is not easy to learn.
Writing the first &quot;Hello, World!&quot; and having it up and running took a few days.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I feel the weight of the language and the ecosystem.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is good news for the developers.
If you know Rust, you have little competition.
Rust developers are expensive.
For the managers, it is bad news.
Rust developers are expensive.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;6-language-features&quot;&gt;6. Language Features&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are many great features in Rust that developers can like.
The code, after you learn the language, can be very readable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However, it can also be very unreadable.
There are Rust quizzes on the net that I do not understand after a month of learning the language.
Not being able to solve it would be natural, but I often do not understand the explanation.
It is partially my age; 40 years of experience does not come young, but it is also the complexity of the language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I usually say that the important question is not&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;BAD QUESTION: How readable code can someone write in a language?&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;rather&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;GOOD QUESTION: How unreadable code can a junior developer, who thinks they mastered it all, write?&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In this regard, Rust is guilty.
The language is open for the developers to be extended.
The developers can write macros, which are part of the language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is similar to the C preprocessor, but macros run during instead of before the compilation.
The input for the macros is the lexical tokens, and the output is the lexical tokens.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To be precise, the macros work on a lexical token tree, not a stream.
It simply means that the paired symbols, like &lt;code&gt;(&lt;/code&gt; and &lt;code&gt;)&lt;/code&gt;, should be in pairs, or else the compiler will complain before passing the lexical tree to the macro.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Java, for example, says that such a &quot;preprocessor&quot; or &quot;macro&quot; is counterintuitive.
The language is powerful enough.
If you need any macro to write your code readable, you have done something wrong; you must learn to use the language better.
Developers, on the other hand, welcome such a possibility.
We love to use the tool and not to &quot;learn it more&quot;.
This is the main reason why projects like Lombok are so hated and loved at the same time.
(In addition to the fact that Lombok is using undocumented API.)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust is on the other end of the scale.
It provides not only macro processing but also allows the developers to interpret the token tree in Rust.
A code written in Rust will start during the compilation and transform part of the lexical tree to another.
Using this possibility, you can significantly alter the language by giving different meanings and semantics to some constructs.
Eventually, you should not do that; it was never intended to introduce procedural macros.
A &quot;clever&quot; junior, however, could.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;7-backward-compatibility&quot;&gt;7. Backward Compatibility&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Backward compatibility is a critical issue.
Pulling an old 8mm magnetic tape zip archive with some Java 1.0 code will compile and run with the newest Java version.
You can compile with the latest C compiler code written in 1970.
(Most of the cases.)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However, as we can see in the case of Java, this hinders language development.
My favorite example is &lt;code&gt;final&lt;/code&gt;.
By the time Java was introduced, the obvious and reasonable choice was to make everything non &lt;code&gt;final&lt;/code&gt; by default.
Hence, we have the &lt;code&gt;final&lt;/code&gt; keyword in Java and do not have something like &lt;code&gt;nonfinal&lt;/code&gt;.
Today most of us feel that &lt;code&gt;final&lt;/code&gt; would be a better default, but it is too late to change it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust cuts this Gordian knot.
Rust introduces the edition mechanism.
There are different editions of Rust, which are essentially language versions.
Inside an edition, a new version is always backward compatible.
Some old conventions can be thrown away when a new edition comes out.
The new compiler, however, can still work with the old code.
It just has to know which edition it is, and the edition is stated in the project&amp;#8217;s &lt;code&gt;Cargo.toml&lt;/code&gt; file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Overall, the use of editions in Rust is an innovative approach to address backward compatibility.
Its effectiveness and impact depends on how it is adopted and used by the Rust developers&apos; community.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;8-libraries&quot;&gt;8. Libraries&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Libraries are also vital parts of the ecosystem.
There are libraries for Rust, but not as wast as for Java.
It clearly shows that mainly enthusiasts support Rust.
Most of the libraries look like well-designed open-source hobby projects.
Documented, but not excessively, covers most use cases, but sometimes not all of them.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are rooms for library development.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;9-tooling&quot;&gt;9. Tooling&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust tooling is excellent.
Eventually not as good as Java, but it is getting there.
I tried to develop a Rust application using IntelliJ IDEA and CLion.
It works; you can also debug the language interactively.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I compiled my sample codes on an Apple M1 machine and coded to generate code for Intel Linux, Intel Windows, and WebAssembly.
Cross-compilation is a strong point of Rust.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are two comments, however, that I got from &lt;a href=&quot;https://github.com/KristofSzabados&quot;&gt;Kristof Szabados&lt;/a&gt; and &lt;a href=&quot;https://github.com/scirin&quot;&gt;Irine Kokilashvili&lt;/a&gt;.
One is that you should avoid cross-compilation if possible.
It is not Rust specific.
Cross compilation, setting up the environment contains many pitfalls that target architecture compilation does not have.
Cross compilation is usually a practice for embedded systems.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The other comment is that Rust compilation using LLVM targets only the those provided by LLVM.
C language using GCC has a wider breath.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;10-implications&quot;&gt;10. Implications&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust is an important language that we have to pay attention to.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;10-1-use-rust&quot;&gt;10.1. Use Rust?&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The big question is: should you use Rust?
When should you use Rust?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you are a developer, allocate time to learn it.
You will need devotion because it is not trivial.
Find some hobby projects or libraries that you will develop in Rust.
Keep Rust in your toolset; it will pay back sooner or later.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you are a manager, know about it.
Encourage your developers to learn it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If your actual project is low-level, more or less a systems programming project, then Rust must be considered.
I do not advocate selecting Rust, but it must be considered.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The decision has to be made based on non-technical requirements.
Rust is mature enough to do anything that C can do.
If there is something prohibited by compile time memory safety, you can still use &lt;code&gt;unsafe&lt;/code&gt; code as a last resort.
Technical requirements make no difference in this case.
The questions you have to ask are&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;How long will the project run? How long will you need to maintain it?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;How many developers will work on the project? Can you afford to have a Rust developer? Can you educate&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Using Rust at the moment is a significant investment.
Rust developers are not available in the market significant amount.
It is a good choice if you can afford to educate your developers to learn Rust.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;10-2-what-will-rust-do&quot;&gt;10.2. What will Rust do ?&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;My opinion is that Rust will be used in many areas.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;10-2-1-systems-programming&quot;&gt;10.2.1. Systems Programming&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For low-level systems programming, it will definitely be a significant player.
The promise to create a memory-safe, &quot;unhackable&quot; program is strong.
There is no general guarantee for the resulting code 100% secure, but a significant share of the security issues use exploits based on memory safety problems.
It is also something that I genuinely believe Rust delivers.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;10-2-2-application-programming&quot;&gt;10.2.2. Application Programming&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But this is not the whole story.
Rust has the potential to be a significant player in enterprise application development.
It has to evolve to have more commercial-grade libraries and a non-niche developer base to get there.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;10-2-3-web-ui-development&quot;&gt;10.2.3. Web UI Development&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I also see the possibility of it being a player in Web UI development.
The reason for the possibility is WebAssembly.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Compiling the code to run in the browser is a prerequisite, but not enough.
The main reason, strangely, is the complexity of Rust.
The needed and delivered code quality of UI projects reflecting the experience of the average UI developer is usually low.
UI developers are usually young and less experienced.
This also means an issue when you have a project that needs more experience.
Finding a senior UI developer may be difficult in the swarm of young developers.
On the other hand, when you find a developer who can program in Rust, you are more likely to find someone who is a senior developer.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;11-summary-and-conclusion&quot;&gt;11. Summary and Conclusion&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Rust is a language that we have to pay attention to.
It is technically mature, and it will become commercially mature in the future.
2023 is the year (my opinion) when it will pass the tipping point.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As a developer, you should learn it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As a manager, you should know about it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article as a source code was available on GitHub since the start of writing.
The people who contributed to the text with comments before the publishing date are:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Juriy&quot;&gt;Iurii Bura&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/KristofSzabados&quot;&gt;Kristof Szabados&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/scirin&quot;&gt;Irine Kokilashvili&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author></entry><entry><title type="html">Open Source Blog</title><link href="https://javax0.github.io/2023/01/31/opensource-blog.html" rel="alternate" type="text/html" title="Open Source Blog" /><published>2023-01-31T00:00:00+01:00</published><updated>2023-01-31T00:00:00+01:00</updated><id>https://javax0.github.io/2023/01/31/opensource-blog</id><content type="html" xml:base="https://javax0.github.io/2023/01/31/opensource-blog.html">&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Article Management Technical Details&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Code &lt;a href=&quot;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-31-opensource-blog&quot;&gt;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-31-opensource-blog&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Article source &lt;a href=&quot;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-31-opensource-blog.adoc.jam&quot;&gt;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-31-opensource-blog.adoc.jam&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-introduction&quot;&gt;1. Introduction&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article is about the philosophy behind creating an open-source blog.
The article will discuss&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;what an open-source blog means&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-what-is-an-open-source-blog&quot;&gt;2. What is an Open-Source Blog?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We know what open-source software (OSS) is.
It is many things.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;OSS is free to redistribute.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Source code is included.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The license allows modification.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Supports the integrity of the author&amp;#8217;s code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;No discrimination against persons or groups.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;No discrimination against fields of endeavor.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Distribution of license.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must not be specific to a product.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must not restrict other software.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must be technology-neutral.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;(source &lt;a href=&quot;https://en.wikipedia.org/wiki/The_Open_Source_Definition&quot;&gt;Wikipedia, Open Source Definition&lt;/a&gt;])&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The initiative of OSS was extended to documentation, for example, the GNU Free Documentation License.
The most well-known licensing scheme is the &lt;a href=&quot;https://en.wikipedia.org/wiki/Creative_Commons_license&quot;&gt;Creative Commons License&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;These mainly focus on the rights and the way the product is used.
It is imperative, and there is a good reason that most approaches look at this side of OSS and documentation.
This side regulates the use and how OSS creates value in the economy.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For me, as a developer, the other side is more important.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Let me use the well-known parable &lt;a href=&quot;https://en.wikipedia.org/wiki/Blind_men_and_an_elephant&quot;&gt;about the blind men and the elephant&lt;/a&gt;.
Everybody touches a different part of the elephant and has a different opinion about what an elephant is.
The industry is mainly interested in the fertilizing output that comes out of the OSS ecosystem.
I stay more at the other end of the elephant, at the trunk and the mouth that feeds the animal.
I drew a picture of an elephant showing the developer side:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://javax0.github.io/assets/images/elephant.png&quot; alt=&quot;elephant&quot; width=&quot;500px&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When we create open-source software, we usually do it for fun.
It is why I was drawing the elephant.
It is fun.
In a commercial project, you never do that.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Also, open source, for me, is cooperation.
We do it together.
There is a  team of developers, and we develop the software together.
Other people use the software, and few start to complain.&lt;/p&gt;
&lt;/div&gt;
&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Four Levels of OSS Developer Success (click to open)&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;You create a project, and no one notices.
It is always how it starts, but even this is fun.
Creating software is fun.
If it is not fun, then don&amp;#8217;t do it.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Some people have started to use your software.
You do not know about it because they do not give you feedback.
You google your project name and may see it mentioned, appearing at places.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;People start asking stupid and annoying questions.
It is the real success.
People believe your software is so good that they invest effort in asking when they cannot get along.
Your users are introverted developers.
From their side, asking is a considerable effort.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;There are hate posts about your software.
It is the ultimate success.
Some people write about why no one should not use your software.
I could never reach this level with any of my projects.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is when you start your OSS project.
When you join an already-running OSS project, it is different.
In that case, you jump on an already running train&amp;#8230;&amp;#8203; sorry: elephant.
Your name gets to the list of developers, and you can be proud that your tiny but essential change was added to the project.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What about blogs?
What will make this blog to be open source?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;It is open for collaboration.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Source code is included.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Blog content is free to redistribute.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The license allows modification.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Supports the integrity of the author&amp;#8217;s code.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;No discrimination against persons or groups.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;No discrimination against fields of endeavor.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Distribution of license.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must not be specific to a product.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must not restrict other software.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must be technology-neutral.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the following sections, I will look at these aspects.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is no separate section in this article for&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The license allows modification&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Distribution of license&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must not be specific to a product&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must not restrict other software&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;License must be technology-neutral&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are provided by the CC-BY license governing the content of the blog.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-it-is-open-for-collaboration&quot;&gt;3. It is open for collaboration&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is the most critical aspect of open-source blogging.
You can use the content of this blog according to the CC-BY license terms.
It allows practically any use, even commercial, so long you attribute the source.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But that is the rear end of the elephant.
We are interested in feeding the elephant.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This blog is maintained in a &lt;a href=&quot;https://www.writethedocs.org/guide/docs-as-code/&quot;&gt;Doc as Code&lt;/a&gt; style.
The blog is edited using markup.
The selected markup is Asciidoc, and I also use the Jamal preprocessor.
The article source files are &lt;code&gt;.adoc.jam&lt;/code&gt; files.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The source is maintained on GitHub in a public repository.
It means that you can look at any article.
Not only those which are already published but also the articles which are under construction.
You can also have a look at the history of article editing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Articles are created and edited for days, sometimes for weeks.
It is similar to program features.
Not to interfere with the already released article set, these article sources are maintained in separate branches.
GitHub allows you to list all these branches and look at what is cooking.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In addition, you can fork the repository, create new articles, and suggest modifications to any article creating a pull request.
True to the open-source philosophy, I will consider every pull request.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-source-code-is-included&quot;&gt;4. Source code is included&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is almost evident in the case of documentation or blogs.
The source is the text itself.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Usually, it is, but that is a mistake.
It is like programming in machine code.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you code in machine code, the binary is the source code.
We don&amp;#8217;t do that.
The reason: it isn&amp;#8217;t easy and involves a lot of mechanical work that computers can do.
We program in high-level languages.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When we document, we still create the documentation in &quot;machine code&quot; to some extent.
Maybe, the level we are in is not machine code.
After all, you do not edit a PDF binary.
What we usually do is assembly level.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The better approach is to use tools to write the documentation at a high level.
Do NOT copy and paste the information from the documented system.
Write code that will do the copy-pasting, reformatting, extracting, and transformation needed for the documentation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Jamal does it for this blog, and Jamal source of the blog articles are available in a public Git repository:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/javax0/javax0.github.io&quot;&gt;https://github.com/javax0/javax0.github.io&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In addition to the source of the articles, the source for the build environment is also in the repository.
You can use them to start your blog if you like.
Their license is Apache 2.0, as denoted by the &lt;code&gt;LICENSE&lt;/code&gt; file in the repo root.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;5-blog-content-is-free-to-redistribute&quot;&gt;5. Blog content is free to redistribute&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is no technical blocker since the code is available as open source.
The license is reasonably permissive, CC-BY.
I even encourage redistribution.
As you can see on the opening page, I have an agreement for many years with DZone and JCG.
I also discussed with Baeldung, but their policy does not fit redistribution.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can find articles from the blog on Chinese, Russian, and Hindi sites.
You can also feel free to copy, modify, and translate as long you follow attribution CC-BY.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;6-supports-the-integrity-of-the-authors-code&quot;&gt;6. Supports the integrity of the author&amp;#8217;s code&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When the article is modified, you have to note it in the attribution so that the readers will know that it is a derivative.
They can easily see the difference between the original and the derived work using backlinking.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;7-no-discrimination-against-persons-or-groups&quot;&gt;7. No discrimination against persons or groups&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am not racist.
There is no need to say more about it.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;8-no-discrimination-against-fields-of-endeavor&quot;&gt;8. No discrimination against fields of endeavor&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is the part that makes me a bit uncomfortable, but what can I do?
If you use the content of my articles to destroy the universe, I must be OK with it.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;9-summary&quot;&gt;9. Summary&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Use the blog!
Do not only READ it!
Be part of this blog!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Reading is fine.
First step.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Commenting is welcome.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Suggesting modifications and writing articles to be published here is the ultimate goal of being an open-source blog.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">Article Management Technical Details Code https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-31-opensource-blog Article source https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-31-opensource-blog.adoc.jam 1. Introduction</summary></entry><entry><title type="html">Ten Useless Things You Did Not Know About Java</title><link href="https://javax0.github.io/2023/01/23/ten-java.html" rel="alternate" type="text/html" title="Ten Useless Things You Did Not Know About Java" /><published>2023-01-23T00:00:00+01:00</published><updated>2023-01-23T00:00:00+01:00</updated><id>https://javax0.github.io/2023/01/23/ten-java</id><content type="html" xml:base="https://javax0.github.io/2023/01/23/ten-java.html">&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Article Management Technical Details&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Code &lt;a href=&quot;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java&quot;&gt;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Article source &lt;a href=&quot;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam&quot;&gt;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Java is a complex language, and some features that initially seemed a good idea turned out to be useless.
In this article, we will look at ten such Java language features.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-java-has-labels&quot;&gt;1. Java Has Labels&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can have labels in your Java code.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         LABEL1:
 2.         for (int i = 0; i &amp;lt; 10; i++) {
 3.             for (int j = 0; j &amp;lt; 10; j++) {
 4.                 if (i * j &amp;gt; 15 &amp;amp;&amp;amp; (i * j) % 2 == 0) break LABEL1;
 5.                 System.out.print(&quot;%d,%d &quot;.formatted(i, j));
 6.             }
 7.             System.out.println();
 8.         }
 9.         System.out.println();
10.         System.out.println();
11.         LABEL2:
12.         for (int i = 0; i &amp;lt; 10; i++) {
13.             for (int j = 0; j &amp;lt; 10; j++) {
14.                 if (i * j &amp;gt; 15 &amp;amp;&amp;amp; (i * j) % 2 == 0) {
15.                     System.out.println();
16.                     continue LABEL2;
17.                 }
18.                 System.out.print(&quot;%d,%d &quot;.formatted(i, j));
19.             }
20.             System.out.println();
21.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Like you could have them in assembly.
Or when you were programming BASIC numbering the lines.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To interrupt an outer loop, you can reference these labels in the &lt;code&gt;break&lt;/code&gt; or &lt;code&gt;continue&lt;/code&gt; command.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The output of the above program is:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7

0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7
3,0 3,1 3,2 3,3 3,4 3,5
4,0 4,1 4,2 4,3
5,0 5,1 5,2 5,3
6,0 6,1 6,2
7,0 7,1 7,2 7,3
8,0 8,1
9,0 9,1&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to compare, here is the version without the labels:&lt;/p&gt;
&lt;/div&gt;
&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Click to open the version without labels&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         for (int i = 0; i &amp;lt; 10; i++) {
 2.             for (int j = 0; j &amp;lt; 10; j++) {
 3.                 if (i * j &amp;gt; 15 &amp;amp;&amp;amp; (i * j) % 2 == 0) break;
 4.                 System.out.print(&quot;%d,%d &quot;.formatted(i, j));
 5.             }
 6.             System.out.println();
 7.         }
 8.         System.out.println();
 9.         System.out.println();
10.         for (int i = 0; i &amp;lt; 10; i++) {
11.             for (int j = 0; j &amp;lt; 10; j++) {
12.                 if (i * j &amp;gt; 15 &amp;amp;&amp;amp; (i * j) % 2 == 0) {
13.                     System.out.println();
14.                     continue;
15.                 }
16.                 System.out.print(&quot;%d,%d &quot;.formatted(i, j));
17.             }
18.             System.out.println();
19.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;and the output&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7
3,0 3,1 3,2 3,3 3,4 3,5
4,0 4,1 4,2 4,3
5,0 5,1 5,2 5,3
6,0 6,1 6,2
7,0 7,1 7,2 7,3
8,0 8,1
9,0 9,1


0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7


3,0 3,1 3,2 3,3 3,4 3,5
3,7
3,9
4,0 4,1 4,2 4,3






5,0 5,1 5,2 5,3
5,5
5,7
5,9
6,0 6,1 6,2







7,0 7,1 7,2 7,3
7,5
7,7
7,9
8,0 8,1








9,0 9,1
9,3
9,5
9,7
9,9&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-you-can-break-from-a-block&quot;&gt;2. You can &lt;code&gt;break&lt;/code&gt; from a Block&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Labels make it possible to break from a block.
It does not need to be a loop.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         for (int i = 1; i &amp;lt;= 15; i++) {
 2.             FIZZ:
 3.             {
 4.                 System.out.printf(&quot;%d &quot;, i);
 5.                 if (i % 3 != 0) break FIZZ;
 6.                 System.out.print(&quot;fiz&quot;);
 7.             }
 8.             BUZZ:
 9.             {
10.                 if (i % 5 != 0) break BUZZ;
11.                 System.out.print(&quot;buzz&quot;);
12.             }
13.             System.out.println();
14.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It will print&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;1
2
3 fiz
4
5 buzz
6 fiz
7
8
9 fiz
10 buzz
11
12 fiz
13
14
15 fizbuzz&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-static-methods-can-also-be-final&quot;&gt;3. &lt;code&gt;static&lt;/code&gt; Methods can also be &lt;code&gt;final&lt;/code&gt;&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When a method is final in a class, you cannot redefine it in a child class.
Static methods, however, are not virtual.
They cannot be redefined.
A static method in the child class of the same signature has nothing to do with the method in the parent class.
Or does it?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Actually, it does.
If the static method is &lt;code&gt;final&lt;/code&gt;, then the child class cannot have a method with the same signature.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To demonstrate this, we compile the test classes dynamically.
We do not want any syntax errors in our demo project.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         final var FIZZ = &quot;&quot;&quot;
 2.                 package com.javax0.blog.tenjava;
 3.                 public class Fizz {
 4.                     static void fizzy(){
 5.                     }
 6.                 }
 7.                 &quot;&quot;&quot;;
 8.         final var BUZZ = &quot;&quot;&quot;
 9.                 package com.javax0.blog.tenjava;
10.                 public class Buzz extends Fizz {
11.                     static void fizzy(){
12.                     }
13.                 }
14.                 &quot;&quot;&quot;;
15.         final var testSet1 = Compiler.java().from(
16.                 FIZZ
17.         ).from(BUZZ).compile().load();
18.         testSet1.get(&quot;Buzz&quot;);
19.         Assertions.assertThrows(Compiler.CompileException.class, () -&amp;gt; Compiler.java().from(
20.                 FIZZ.replaceAll(&quot;static void&quot;, &quot;final static void&quot;)
21.         ).from(BUZZ).compile());&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We compile FIZZ and BUZZ.
Both classes have a method named &lt;code&gt;fizzy()&lt;/code&gt;.
No problem.
Then we change the method in the class &lt;code&gt;Fizz&lt;/code&gt; to &lt;code&gt;final&lt;/code&gt;.
Now the compilation fails.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You cannot &quot;override&quot; the final method.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-goto-is-a-reserved-word&quot;&gt;4. &lt;code&gt;goto&lt;/code&gt; is a reserved word&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is no &lt;code&gt;goto&lt;/code&gt; in Java; still, &apos; goto` is a keyword.
The designers of the language thought it to be a good idea.
Future versions of Java may have a &lt;code&gt;goto&lt;/code&gt; statement.
Let&amp;#8217;s reserve this as a keyword.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         Compiler.java().from(&quot;&quot;&quot;
 2.                 package com.javax0.blog.tenjava;
 3.                 class NoGotoPlease{
 4.                   public void _goto(){
 5.                   }
 6.                 }
 7.                 &quot;&quot;&quot;
 8.         ).compile();
 9.         Assertions.assertThrows(Compiler.CompileException.class, () -&amp;gt; Compiler.java().from(&quot;&quot;&quot;
10.                 package com.javax0.blog.tenjava;
11.                 class NoGotoPlease{
12.                   public void goto(){
13.                   }
14.                 }
15.                 &quot;&quot;&quot;
16.         ).compile());&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If we name the method &lt;code&gt;_goto&lt;/code&gt;, it is okay.
Using it without an underscore in the front: it is a keyword.
It does not compile.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you consider that &lt;code&gt;var&lt;/code&gt;, on the other hand, is NOT a keyword&amp;#8230;&amp;#8203;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;5-var-is-not-a-keyword-in-java&quot;&gt;5. &lt;code&gt;var&lt;/code&gt; is not a keyword in Java&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Java 10  introduced &lt;code&gt;var&lt;/code&gt;.
There are a lot of articles about how you can use &lt;code&gt;var&lt;/code&gt; and why &lt;code&gt;var&lt;/code&gt; is not syntactic sugar.
However, &lt;code&gt;var&lt;/code&gt; is also not a keyword.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If it was a keyword, we could have a program, like&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1. public class VarNotKeyword {
 2.     final int var = 13;
 3.
 4.     void myMethod() {
 5.         int var = var().var;
 6.     }
 7.
 8.     VarNotKeyword var() {
 9.         return new VarNotKeyword();
10.     }
11.
12. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;which was a valid code before Java 10.
It still is because &lt;code&gt;var&lt;/code&gt; is not a keyword, but it would be ruined if it was.
Luckily, it is not.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You cannot name a class to be &lt;code&gt;var&lt;/code&gt;.
This means that even though &lt;code&gt;var&lt;/code&gt; is not a keyword, we may still have some incompatibility.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;6-stream-operations-are-mutating&quot;&gt;6. Stream operations are mutating&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is also a Java secret, but at least this knowledge is not useless.
After all, who would like to read an article full of useless things?
As a matter of fact, there was a question on a Java interview, so it may even be essential to know.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you chain the stream methods, they transform streams.
There is no operation happening until the final terminal operation is chained up and starts to execute.
The stream operations without the terminal operation only build up the operation chain.
They transform one stream into a new stream.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Not only!&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Stream operations, like &lt;code&gt;map&lt;/code&gt;, also modify the stream they are attached to.
The stream will remember that an operation was already attached to it and will throw an exception if you try to form a stream.
The following code demonstrates this:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final Stream&amp;lt;Object&amp;gt; stream = Stream.of(&quot;a&quot;, 2, 3, new Object[2]);
2.         final var stringStream1 = stream.map(Object::toString);
3.         try {
4.             final var stream2 = stream.map(obj -&amp;gt; &quot; &quot; + obj);
5.         } catch (IllegalStateException e) {
6.             System.out.println(e);
7.         }
8.         final var string = stringStream1.collect(Collectors.joining(&quot;\n&quot;));&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The output of this is:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;java.lang.IllegalStateException: stream has already been operated upon or closed&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;7-streams-do-not-always-run&quot;&gt;7. Streams do not always run&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You know that the intermediary operations on a stream do not run if there is no terminal operation.
The terminal operation is the one that runs the streams invoking all the intermediary ones for the elements.
However, not all terminal operations run the whole chain.
It may lead to surprises in some cases.
To see that, let&amp;#8217;s use &lt;code&gt;peek()&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;peek()&lt;/code&gt; is a stream intermediary method that does not modify the stream.
The Javadoc of the method in the official JDK documentation says:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This method exists mainly to support debugging, where you want to see the elements as they flow past a certain point in a pipeline.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The same Javadoc then gives a sample that uses &lt;code&gt;System.out.println&lt;/code&gt; to print values from a stream in different stages.
We will do the same&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final var w = Stream.of(1, 2, 3, 4, 5, &quot;apple&quot;, &quot;bird&quot;, 3.1415926)
2.                 .peek(System.out::println).toArray();
3.         System.out.println(w.length);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This sample goes through the elements of the stream.
It prints the elements of the stream and then the number of the elements as we have collected them to an &lt;code&gt;Object[]&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;1
2
3
4
5
apple
bird
3.1415926
8&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is nice and dandy.
What if we do not collect the elements?
In the example above, we are only interested in the number of elements; there is no reason to collect them into an array.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final long z = Stream.of(1, 2, 3, 4, 5, &quot;apple&quot;, &quot;bird&quot;, 3.1415926)
2.                 .peek(System.out::println).count();
3.         System.out.println(z);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We expect to get the same output as before.
The reality, however, is that the output this time is:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;8&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Where did the elements go?
Why &lt;code&gt;peek&lt;/code&gt; does not print the elements?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In this case, the terminal operation &lt;code&gt;count()&lt;/code&gt; does not execute the stream pipeline.
Therefore, the &lt;code&gt;peek()&lt;/code&gt; action is not invoked.
There is no magic or secret in it.
The JavaDoc of &lt;code&gt;count()&lt;/code&gt; explains it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;An implementation may choose to not execute the stream pipeline &amp;#8230;&amp;#8203; if it is capable of computing the count directly from the stream source.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In some cases, like the one in the example above, the terminal operation &lt;code&gt;count()&lt;/code&gt; does not need to iterate through the stream to know the number of elements.
So it does not.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Even the documentation of &lt;code&gt;peek()&lt;/code&gt; has a link to this fact.
Nobody reads documentation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;8-strictfp-is-a-modifier&quot;&gt;8. &lt;code&gt;strictfp&lt;/code&gt; is a modifier&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once upon a time, there was a keyword called &lt;code&gt;strictfp&lt;/code&gt;.
It was introduced in Java 1.2 and required the floating point calculations to be performed differently.
Floating point calculations traditionally used the format IEEE 754 standard defined.
The early x86 processors with the x87 floating point coprocessor worked differently.
The coprocessor used a longer format, allowing more precision.
The &lt;code&gt;float&lt;/code&gt; and &lt;code&gt;double&lt;/code&gt; values were 64bit, but the generated code stored the intermediate values on more bits during a calculation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Before Java 1.2, the compiler generated machine code modifying the result of every intermediate value to 64bit.
This required extra machine code operations and slowed the calculation down.
It was not only slower but more error-prone to overflow errors.
A calculation result could be okay with the 64-bit precision while some intermediate values overflowed.
Using more precision provided by the hardware could lead to the correct value.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;strictfp&lt;/code&gt; was introduced to let the compiler generate a more effective floating-point code.
With 1.2 and later till Java 17, the compiler generates code using the extra precision unless the class or method is &lt;code&gt;strictfp&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;just kidding&lt;/div&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;strictfp&lt;/code&gt; means that the floating calculation will result in the exact wrong result on all platforms.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Times change.
Pentium 4 in 2001 allows the compiler to avoid the extra code for strict floating point.
Java could generate the strict floating point effectively.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Java 17 came 20 years later, and Java changed again.
Java 17 later uses strict arithmetic even when &lt;code&gt;strictfp&lt;/code&gt; is not specified.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can still use it, and reflectively query its existence on a class, interface, or non-abstract method, but the Java compiler does not use it anymore.
Maybe, the Java compiler was the only one using &lt;code&gt;strictfp&lt;/code&gt; even in the past.
At least, I have never met anyone who needed that and used it.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;9-there-are-multiple-arraylist-implementations-in-the-jdk&quot;&gt;9. There are multiple &lt;code&gt;ArrayList&lt;/code&gt; implementations in the JDK&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you have programmed Java for a long time, you know that you can easily create a list of elements calling &lt;code&gt;Array.asList()&lt;/code&gt;.
If you look at the implementation of this static method, you can see that it is simply:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;    @SafeVarargs
    @SuppressWarnings(&quot;varargs&quot;)
    public static &amp;lt;T&amp;gt; List&amp;lt;T&amp;gt; asList(T... a) {
        return new ArrayList&amp;lt;&amp;gt;(a);
    }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;in the class &lt;code&gt;java.util.Arrays&lt;/code&gt;.
Although the method&amp;#8217;s return type is the interface &lt;code&gt;List&lt;/code&gt;, the documentation guarantees that the return type is &lt;code&gt;ArrayList&lt;/code&gt;.
It says&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Returns a fixed-size list backed by the specified array.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So it is an &lt;code&gt;ArrayList&lt;/code&gt;.
Yes and no.
Let&amp;#8217;s try the following program:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         try {
2.             final ArrayList&amp;lt;Integer&amp;gt; x = (ArrayList) Arrays.asList(1, 2, 3, 4);
3.         } catch (ClassCastException cce) {
4.             System.out.println(cce);
5.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The output will be&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;java.lang.ClassCastException: class java.util.Arrays$ArrayList cannot be cast to class java.util.ArrayList (java.util.Arrays$ArrayList and java.util.ArrayList are in module java.base of loader &apos;bootstrap&apos;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The returned list is an &lt;code&gt;ArrayList&lt;/code&gt;, but it is a &lt;code&gt;java.util.Arrays$ArrayList&lt;/code&gt; and not &lt;code&gt;java.util.ArrayList&lt;/code&gt;.
These are two different classes and are not compatible.
One cannot be converted to the other; only the simple name is the same.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
Two classes are the same if their &lt;em&gt;canonical name&lt;/em&gt; is the same and were loaded by one class loader.
The simple name being the same is not enough.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Why did the implementors of &lt;code&gt;asList()&lt;/code&gt; create a new &lt;code&gt;ArrayList&lt;/code&gt; class?
Probably they wanted to create optimized code.
The list this method returns is backed up by an array just like the &lt;code&gt;java.util&lt;/code&gt; one.
However, this array cannot be resized.
It is the same array that you provided as an argument.
It is not copied or cloned.
It remains in its place and is used by the list implementation.
You can see that in the following code sample:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final Integer[] w = {1, 2, 3};
2.         final var wl = Arrays.asList(w);
3.         Assertions.assertEquals(1, wl.get(0));
4.         w[0] = 55;
5.         wl.set(1, 66);
6.         Assertions.assertEquals(55, wl.get(0));
7.         Assertions.assertEquals(66, w[1]);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When the code modifies the array, the list also gets modified.
When the list is modified, the array also gets modified.
That is because they are one and the same.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;10-something-something&quot;&gt;10. something != something&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Recently a friend (Istvan Kovcs) posted a puzzle on &lt;a href=&quot;https://www.linkedin.com/feed/update/urn:li:activity:7022233914991640576/&quot;&gt;Linked-in&lt;/a&gt;.
What should you write to the place of &lt;code&gt;???&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final var variable = ???;
2.         if( variable == variable ){
3.             Assertions.fail(&quot;variable is == to variable&quot;);
4.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The question was: what should you write into the place of the &lt;code&gt;???&lt;/code&gt; characters?
Unless you want to have a failing test, you need something which is not equal to itself.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It cannot be an object, because &lt;code&gt;==&lt;/code&gt; compares the reference &quot;address&quot;, therefore an object is always &lt;code&gt;==&lt;/code&gt; to itself.
It can only be a primitive value.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The solution comes from the &lt;a href=&quot;https://ieeexplore.ieee.org/document/30711&quot;&gt;IEEE 754&lt;/a&gt; standard.
It has the sentence:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The exceptions are C predicates  x == x  and  x != x , which are respectively 1 and 0 for every
infinite or finite number x but reverse if x is Not a Number ( NaN )&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Although it talks about the C language, Java has inherited a lot from it.
Java implements the standard as we have already discussed related to the &lt;code&gt;strictfp&lt;/code&gt; keyword.
That way the code sample is&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final var variable = Float.NaN;
2.         if( variable == variable ){
3.             Assertions.fail(&quot;variable is == to variable&quot;);
4.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final var variable = Double.NaN;
2.         if( variable == variable ){
3.             Assertions.fail(&quot;variable is == to variable&quot;);
4.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;11-summary&quot;&gt;11. Summary&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We have visited ten Java features.
These are not important.
Writing about these was fun, and I hope reading them was also fun.
I tried to be precise, and I could not resist including some information that may also be useful despite the article title.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you know any other more or less useless facts about Java, please write them down in the comments.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">Article Management Technical Details Code https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java Article source https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam</summary></entry><entry><title type="html">Hidden Classes in Java 15</title><link href="https://javax0.github.io/2023/01/05/hidden-classes.html" rel="alternate" type="text/html" title="Hidden Classes in Java 15" /><published>2023-01-05T00:00:00+01:00</published><updated>2023-01-05T00:00:00+01:00</updated><id>https://javax0.github.io/2023/01/05/hidden-classes</id><content type="html" xml:base="https://javax0.github.io/2023/01/05/hidden-classes.html">&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Article Management Technical Details&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Code &lt;a href=&quot;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-05-hidden-classes&quot;&gt;https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-05-hidden-classes&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Article source &lt;a href=&quot;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-05-hidden-classes.adoc.jam&quot;&gt;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-05-hidden-classes.adoc.jam&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-introduction&quot;&gt;1. Introduction&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Java can have anonymous classes from the very start.
(Well, actually, they came in version 1.1 only.)
However, anonymous classes were not anonymous.
You did not need to name them, but under the hood, they were named by the Java compiler.
If you are familiar with the command &lt;code&gt;javap&lt;/code&gt;, you can &quot;disassemble&quot; a JAR file and see the name of the compiler generated for the anonymous classes.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Java 15 introduced hidden classes, which do not have a name.
Almost, as you will see.
It is not part of the language but part of the JDK.
There is no language element to create hidden classes, but JDK methods and classes come to the rescue.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In this article, we will discuss&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;what hidden classes are, and what is the reason to have them,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;how you can use hidden classes,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;how to load hidden classes using the JDK methods and, finally&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;how to easily create and load hidden classes using &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I created SourceBuddy, an Apache v2.0 licensed open-source program.
While creating the code, I learned a few things about hidden classes I wanted to share with you.
You may also look at this article as a SourceBuddy promotion, which is ok if you do that.
Nevertheless, I hope to successfully add extra value to this article so that this is not simply a promo.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-what-are-hidden-classes&quot;&gt;2. What are hidden classes?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is an easy-to-read &lt;a href=&quot;https://www.baeldung.com/java-hidden-classes&quot;&gt;introductory article&lt;/a&gt; about hidden classes on Baeldung.
If you are impatient and do not care about some intricate details, go there and read that article.
Baeldung articles are always short, focusing on the most important and correct.
They give a good starting point, which there would be no reason to repeat.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Hidden classes were proposed in the &lt;a href=&quot;https://openjdk.org/jeps/371&quot;&gt;JEP371&lt;/a&gt;, and it reads:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;hidden &amp;#8230;&amp;#8203; classes that cannot be used directly by the bytecode of other classes&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is a bit short and may not be easy to understand.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;A hidden class is loaded into the JVM.
When a class is in source code format or byte code, it cannot be &quot;hidden&quot;.
This term can refer only to loaded classes.
Calling them secretly loaded classes could be more appropriate.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;A class gets hidden when it is loaded in a particular way so that it remains secret in front of other code parts.
Remaining hidden does not mean that other codes cannot use this class.
They can so long as long they &quot;know&quot; about the secret.
The big difference is that this class is not &quot;advertised&quot; because you cannot find it using the name.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you load a class the hidden way creating a hidden class, you will have a reference to this class.
Using the reflective methods, you can instantiate the class many times, and then you can invoke methods, set, and get fields.
If the class implements an interface or extends a class, you can cast the instance reference to the interface and class and invoke the methods without reflection.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The class is hidden for two reasons:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;it does not have a name other classes could reference, and&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;there is no reference from the class loader to the class.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you call &lt;code&gt;getName()&lt;/code&gt; or &lt;code&gt;getSimpleName()&lt;/code&gt; on a variable referencing a hidden class, you will get some string.
These are names for messages for humans and are irrelevant for the other classes.
When a class refers to another class it needs the canonical name.
&lt;code&gt;getCanonicalName()&lt;/code&gt; returns &lt;code&gt;null&lt;/code&gt;.
The canonical name is the actual name of the class, which is non-existent in the case of hidden classes.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since the class cannot be found through the class loader without the canonical name, there is no reason for the loader to keep a reference to the class.
Why would it keep a reference when it cannot give the class to anyone?
Keeping a reference would have only one side effect: preventing the GC from unloading the class so long as the class loader is alive.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Since there is no reference from the class loader, the GC can unload the class object as soon as it is out of use.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-what-is-the-use-of-hidden-classes&quot;&gt;3. What is the use of hidden classes?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The &lt;a href=&quot;https://openjdk.org/jeps/371&quot;&gt;JEP371&lt;/a&gt; describes the reason for hidden classes.
It says&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Allow frameworks to define classes as non-discoverable implementation details of the framework so that they cannot be linked against other classes nor discovered through reflection.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Many frameworks use dynamically created classes.
They are proxy classes in most cases.
A proxy class implements an interface or extends another class, and when invoked, it calls an instance of the interface or the original class.
It usually does something extra as well, or else there would be no reason for the proxy class and instance.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;An example is the Spring framework when your code requires injecting a request bean into a session bean.
(Or any other shorter lifecycle bean into a longer one.)
Several threads can serve different requests at the same time, all belonging to the same session.
All these threads will see the same session bean, but they magically will see their request beans.
The magic is a proxy object extending the request bean&amp;#8217;s class.
When you call a method on the request bean, you invoke the proxy instance.
It checks the thread and the request it serves and forwards the call to the appropriate request bean.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Another example is JPA lazy loading.
You can have an SQL table where each row references the previous one.
When you try to load the last record, it will automatically load the previous one, which indeed will load the one before.
It will load the whole table.
It happens unless you annotate the field as lazy.
It means that the actual data from the database has to be loaded only when it is needed.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you load the record, you get a proxy object.
This proxy object knows which record it refers to and will load the record from the database only when a method is called.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The same mechanism is used for Aspect Oriented Programming and many other cases.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can create a proxy class using only the JDK reflection API so long as the target class implements the interface you want to proxy.
You can use the &lt;a href=&quot;https://bytebuddy.net/&quot;&gt;ByteBuddy&lt;/a&gt; library if there is no such interface.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/cglib/cglib&quot;&gt;cglib&lt;/a&gt; library is widely used and well-known in many frameworks, but it has been deprecated recently.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you create such classes, you do not need any name for these classes.
You get the reference to the class and the reference to the instance.
The framework injects the reference to the field it has to, and then the code uses them as any object.
It does not need to know the name of the class.
All it needs to know is that it is an instance of the target class or interface.
However, some codes may discover the name.
These classes have some names that reflection can discover.
Some &quot;clever&quot; junior may discover it and play some neat trick that you may have later issues maintaining.
Would it be better if there was no name at all?
Probably yes, it would be cleaner.
Hence: hidden classes.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The proxy classes may also cause issues when you implement the &lt;code&gt;equals(Object other)&lt;/code&gt; method.
The usual implementation of the &lt;a href=&quot;https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)&quot;&gt;equals&lt;/a&gt; method compares the &lt;code&gt;other&lt;/code&gt; object&amp;#8217;s class to the actual class.
It will eventually be &lt;code&gt;false&lt;/code&gt; when the other object is a proxy instance.
What the &lt;code&gt;equals()&lt;/code&gt; method should check is the assignability whenever there is a possibility that the &lt;code&gt;other&lt;/code&gt; object is a proxy.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In addition to that, there is another reason to have hidden classes.
As soon as a class has a name, it is possible to discover it by the name.
The class loader has to keep the class alive to keep it discoverable.
The class loader has a reference to the loaded classes.
It means the garbage collector will not be able to collect the class, even when it is no longer in use.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If a class has no name, the class loader does not need to keep a reference to this class.
Class loaders do not keep references to hidden classes unless you explicitly instruct them to do so.
When all instances of a hidden class are collected, and there is no reference to the class, the garbage collector will recognize it as garbage.
The class loader will not keep the class in memory.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That way, the frameworks will not over-consume memory when a long-running code creates a lot of classes.
Better frameworks that collect unused classes do not need to create separate class loaders for these ephemeral classes.
There is no need to create a short-living, disposable class loader to make the class also disposable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Support extending an access control nest with non-discoverable classes.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is the second bullet point in the list of goals in the &lt;a href=&quot;https://openjdk.org/jeps/371&quot;&gt;JEP371&lt;/a&gt;.
JVM can load hidden classes in a way that they become a member of a nest.
What is a nest?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you know what a nesting host is and are impatient, jump to the following quote.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Well, it is a long story, but since it is Christmas time, I am on holiday, and the press will not print this article on the paper wasting tree, here it goes.
(I wrote this article for weeks. It is still not published, and already next year, January.)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once upon a time, Java version 1.0 did not have inner classes.
Now, you better stop reading it here if you ask me what inner classes are.
Then Java version 1.1 introduced inner classes but did not change the JVM structure.
The JVM did not know anything about inner classes.
The Java compiler created regular (almost) top-level classes from the inner classes.
It invented some funny names, like &lt;code&gt;A$B&lt;/code&gt; when there was a class &lt;code&gt;B&lt;/code&gt; inside &lt;code&gt;A&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
You can try to define an &lt;code&gt;A$B&lt;/code&gt; top-level class in the same package where the class &lt;code&gt;A&lt;/code&gt; containing the class &lt;code&gt;B&lt;/code&gt; is.
&lt;code&gt;A$B&lt;/code&gt; is a valid name.
You will see what the compiler does.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There was some hacking with the visibility though.
An inner class has the same visibility as the top-level class.
Anything private inside one compilation unit (file) is visible.
Visibility, however, is also enforced by the JVM.
But the JVM sees two top-level classes.
The compiler generated bridge methods in the classes wherever needed to overcome this issue.
They are package level for the JVM, and when called, they pass on the call to the private method.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then came Java 11 something like 25 years later and &lt;a href=&quot;https://openjdk.org/jeps/181&quot;&gt;introduced the nest control&lt;/a&gt;.
Since Java 11, every class has a relation to another class or to itself, which is the nest host of the class.
Classes having the same nest host can see each other&amp;#8217;s, private members.
The JVM does not need the bridge methods anymore.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you load a class hidden, you can specify it to become a member of the same nest (having the same nest host) as the class that created the lookup object.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
We have not yet discussed what a lookup object is and how to load a class hidden.
It will come.
As for now: a lookup object is something that can load a byte array as a hidden class into the JVM memory.
When a lookup object is created from inside a method of a class, the lookup object will belong to that class.
When a class is loaded as hidden using the lookup object, it is possible to pass an option to make the new hidden class belong to the nest in which the code created the lookup object.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Without the hidden class functionality, I do not know any other possibility to load a class that will belong to an already existing nest.
If you know of any possibility, write it in a comment.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The following bullet point reads:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Support aggressive unloading of non-discoverable classes, so that frameworks have the flexibility to define as many as they need.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is an important point.
When you create a class, it remains in the memory so long as the classloader is alive.
Classloaders keep references to all the classes they loaded.
These references say that some code may ask the classloader to return the loaded class object by the name.
The application logic may long forget the class; nobody will ever need it.
Still, the garbage collector cannot collect it because there is a reference in the class loader.
A solution is to create a new class loader for every new non-hidden dynamically created class, but that is overkill.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Classloaders loading hidden classes do not keep a reference to the hidden class by default.
As with the nesting host, it is possible to provide an option to differ.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I do not see any reason.
There is no name, not discoverable, but keep an extra reference so the GC cannot throw it away.
If you see any reasonable use case, again: comment.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Deprecate the non-standard API sun.misc.Unsafe::defineAnonymousClass, with the intent to deprecate it for removal in a future release.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Very well.
Yes.
Absolutely.
Separate articles and many of them.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Do not change the Java programming language in any way.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Nice point. Sure.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;With these, we discussed what hidden classes are.
You should have a firm understanding of their nature and why they are essential.
We also derailed a bit to nest hosting or host nesting, nesting hosting&amp;#8230;&amp;#8203; whatever.
I hope it was of some value.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the following, I will discuss how we create hidden classes using the JDK API and then using &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-creating-hidden-classes&quot;&gt;4. Creating Hidden Classes&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Articles and tutorials showing how to load hidden classes use precompiled Java classes.
These are usually part of the running application.
The tutorial calculates the path to the &lt;code&gt;.class&lt;/code&gt; file and reads the byte code.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Technically this is correct but does not demonstrate the basic need for hidden class loading: load dynamically created classes hidden.
These classes are not dynamically created and could be loaded the usual way.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In this article, we will create a class from text, Java source on the fly&amp;#8201;&amp;#8212;&amp;#8201;during run-time&amp;#8201;&amp;#8212;&amp;#8201;and then load the resulting byte code as a hidden class.&lt;/p&gt;
&lt;/div&gt;
&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Code Sample Disclaimer&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The code samples are available on GitHub in the &lt;a href=&quot;https://github.com/javax0/javax0.github.io/tree/master/_projects&quot;&gt;project directory&lt;/a&gt;.
Each article has a project directory named &lt;code&gt;YYYY-MM-DD-article-title&lt;/code&gt; where the project code files are.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For this article it is &lt;code&gt;2023-01-05-hidden-classes&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The samples are automatically copied from the project directory to the article using Jamal.
No manual copy, no outdated stale samples.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The sample project for this article contains only unit test files.
The class is &lt;code&gt;TestHiddenClassLoader&lt;/code&gt;.
We have the source code for the hidden class stored in a field variable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.     private static final String CODE1 = &quot;&quot;&quot;
 2.             package com.javax0.blog.hiddenclasses;
 3.
 4.             public class MySpecialClass implements TestHiddenClassLoader.Hello {
 5.
 6.                 @Override
 7.                 public void hello() {
 8.                     System.out.println(&quot;Hello, from the hidden class.&quot;);
 9.                 }
10.             }
11.             &quot;&quot;&quot;;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The interface is also inside the same class.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.     interface Hello {
2.         void hello();
3.     }
4.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The following code is from one of the unit tests:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final var byteCode = Compiler.java().from(CODE1).compile().get();
2.         final var lookup = MethodHandles.lookup();
3.         final var classLookup = lookup.defineHiddenClass(byteCode, true);
4.         final var helloClass = (Class&amp;lt;Hello&amp;gt;) classLookup.lookupClass();
5.
6.         final var hello = helloClass.getConstructor().newInstance();
7.         hello.hello();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We use the &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; library in this code to compile the Java source to byte code.
The first line of the sample does that.
We use &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; version 2.1.0.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We need a lookup object to load the compiled byte code as a hidden class.
This object is created on the second line.
The lookup object is used on the third and fourth lines to load the class hidden.
Line 3 defines the class loading it into the JVM.
The second argument, &lt;code&gt;true&lt;/code&gt;, initializes the class.
That is when the &lt;code&gt;static{}&lt;/code&gt; blocks execute.
The last line invokes the interface-defined method &lt;code&gt;hello()&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now the local variable &lt;code&gt;hello&lt;/code&gt; is an instance of an object, a hidden class.
What are a hidden class&amp;#8217;s name, simple name, and canonical name?
Let&amp;#8217;s print it out.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         System.out.println(&quot;1. &quot; + hello.getClass());
2.         System.out.println(&quot;2. &quot; + hello.getClass().getClassLoader());
3.         System.out.println(&quot;3. &quot; + this.getClass().getClassLoader());
4.         System.out.println(&quot;4. &quot; + hello.getClass().getSimpleName());
5.         System.out.println(&quot;5. &quot; + hello.getClass().getName());
6.         System.out.println(&quot;6. &quot; + hello.getClass().getCanonicalName());
7.         System.out.println(&quot;7. &quot; + lookup.getClass());
8.         System.out.println(&quot;8. &quot; + lookup.getClass().getClassLoader());&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;Output Disclaimer&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
The output in the unit tests is redirected calling &lt;code&gt;System.setOut()&lt;/code&gt;.
The output is collected to a file and then this file is included calling &lt;code&gt;include [verbatim]&lt;/code&gt; Jamal macro into the article.
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Hello, from the hidden class.
1. class com.javax0.blog.hiddenclasses.MySpecialClass/0x00000008011b0c00
2. jdk.internal.loader.ClassLoaders$AppClassLoader@5b37e0d2
3. jdk.internal.loader.ClassLoaders$AppClassLoader@5b37e0d2
4. MySpecialClass/0x00000008011b0c00
5. com.javax0.blog.hiddenclasses.MySpecialClass/0x00000008011b0c00
6. null
7. class java.lang.invoke.MethodHandles$Lookup
8. null&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can see the output from calling &lt;code&gt;hello()&lt;/code&gt; and then the name as printed from the implicit &lt;code&gt;toString()&lt;/code&gt; from the class object, the class loader that loaded the hidden class, the simple name, the name, and in the last line the canonical name.
This last one is interesting as it is &lt;code&gt;null&lt;/code&gt;, showing no class name.
It is hidden.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The class, although hidden, has a reference to the class loader that loaded it.
It is needed when there is anything to resolve during the execution of the code.
The difference is that the class loader does not have a reference to the class.
One direction from the class to the loader exists, but the other direction from the loader to the class does not.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The class loader is the same as the one that loaded the class calling &lt;code&gt;MethodHandles.lookup()&lt;/code&gt;.
You can see that since we printed out the class loader of the &lt;code&gt;this&lt;/code&gt; object in the test.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Finally, we also print out the class of the lookup object and the class loader.
The latter is &lt;code&gt;null&lt;/code&gt;, which means the bootstrap class loader loaded it. (For more information on class loaders, I can recommend reading the article &lt;a href=&quot;https://www.baeldung.com/java-classloaders&quot;&gt;class loaders&lt;/a&gt; from the Baeldung blog.)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You should also note that the interface &lt;code&gt;hello&lt;/code&gt; is package private.
It is still visible for the dynamically created code because it is in the same package and module.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Starting with Java 9, there is a module system in Java.
Many developers I meet say they are not interested in JPMS; they do not need to use it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The fact is that you DO use it, whether you want it or not.
It is the same as concurrent programming.
Java is concurrent; at least there are three threads in a JVM, so your code runs in a concurrent environment, whether you want it or not.
You may not have trouble understanding the details for a long time.
However, when you start digging deeper and creating code that uses some &quot;tricks&quot; or does something special, you almost certainly face some weird errors.
You must know and understand the underlying theory to understand the errors, handle them, mitigate the cause, and fix the bug.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Loading hidden classes dynamically created is precisely such a trick.
You should learn Java Modules.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When the hidden class is loaded, it is in the same package as the one where the interface is defined.
It is not enough, however, as we will see an example in the next section.
It is also a requirement that the same class loader loads the interface and the hidden class.
That way, the interface, and the hidden class are in the same module, in this case, the same unnamed module.
The different class loaders load classes into different modules; thus, when you load a class using a different class loader, it may not see the package fields, methods, interfaces, etc., even if they are in the same package.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is not the only requirement that the lookup object is from the same module.
It is also a requirement that it is from the same package as the class to be loaded.
We must stop here to clarify things, to be painfully precise, because it is easy to confuse things at this point.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The lookup object is an instance of a class in the &lt;code&gt;java.lang.invoke&lt;/code&gt; package.
The class loader loaded this class is &lt;code&gt;null&lt;/code&gt; as shown in the output.
It means the bootstrap class loader.
The bootstrap class loader is implemented in C/C++ and not in Java.
No corresponding Java object represents this class loader; thus, there cannot be a reference to it.
It is solved by returning &lt;code&gt;null&lt;/code&gt; from &lt;code&gt;getClassloader()&lt;/code&gt;.
There is a module, package, and class that &quot;belongs&quot; to the lookup object.
The code&amp;#8217;s module, package, and class were called the &lt;code&gt;MethodHandles.lookup()&lt;/code&gt; method.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You cannot create a hidden class from one package for another.
If you try that, like in the following sample code:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         try {
2.             final var byteCode = Compiler.java()
3.                     .from(&quot;package B; class A{}&quot;).compile().get();
4.             MethodHandles.lookup().defineHiddenClass(byteCode, true);
5.         } catch (Throwable t) {
6.             System.out.println(t);
7.         }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;still from the test class &lt;code&gt;com.javax0.blog.hiddenclasses.TestHiddenClassLoader&lt;/code&gt;.
The class to be loaded is NOT in the same package as the caller for &lt;code&gt;MethodHandles.lookup()&lt;/code&gt;.
It will result in the printout:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;java.lang.IllegalArgumentException: B.A not in same package as lookup class&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;5-creating-hidden-classes-the-easy-way&quot;&gt;5. Creating hidden classes the easy way&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the previous section, we created a new class dynamically and loaded the new class hidden.
The loading was done using lookup objects we acquired from the &lt;code&gt;MethodHandles&lt;/code&gt; class.
In this section, we will see how we can do the same by calling the fluent API of &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The code creating a class saying hello is the following:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final var hello = Compiler.java()
2.                 .from(CODE1.replaceAll(&quot;\\.Hello&quot;, &quot;.PublicHello&quot;)).hidden()
3.                 .compile().load().newInstance(PublicHello.class);
4.         hello.hello();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In this code, we replaced the interface from &lt;code&gt;Hello&lt;/code&gt; to &lt;code&gt;PublicHello&lt;/code&gt;, which you may guess:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.     public interface PublicHello {
2.         void hello();
3.     }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is essentially the same as the previous interface but is &lt;code&gt;public&lt;/code&gt;.
The process is much more straightforward than before.
We specify the source code; we declare that it is a hidden class calling &lt;code&gt;hidden()&lt;/code&gt;, and we compile, load, and ask for an instance cast to &lt;code&gt;PublicHello&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If we want to use the package-private interface, like (not replacing &lt;code&gt;Hello&lt;/code&gt; to &lt;code&gt;PublicHello&lt;/code&gt;):&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         Assertions.assertThrows(IllegalAccessError.class, () -&amp;gt;
2.                 Compiler.java().from(CODE1).hidden().compile().load().newInstance(PublicHello.class));&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;we will get an error.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;java.lang.IllegalAccessError: class com.javax0.blog.hiddenclasses.MySpecialClass/0x00000008011b1c00 cannot access its superinterface com.javax0.blog.hiddenclasses.TestHiddenClassLoader$Hello (com.javax0.blog.hiddenclasses.MySpecialClass/0x00000008011b1c00 is in unnamed module of loader com.javax0.sourcebuddy.ByteClassLoader @4e5ed836; com.javax0.blog.hiddenclasses.TestHiddenClassLoader$Hello is in unnamed module of loader &apos;app&apos;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The reason is explained clearly in the error message.
The interface and the class implementing it are in two different modules.
Both are unnamed modules, but they are not the same.
In Java, starting with Java 9, there are modules, and when the application does not use modules, it essentially creates pseudo modules putting the classes there.
The JDK classes are still in modules, like &lt;code&gt;java.base&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The hidden class creation, as created above, uses a separate class loader to load the dynamically written Java class.
The separate class loader loads classes to its module.
Code in different modules cannot see classes from other modules unless they are public.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Although &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; does a little trick to load a class hidden, it cannot overcome this restriction.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Loading a hidden class needs a lookup object.
The application usually provides this object.
The calls above do not specify any lookup object, but &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; still needs one.
To have one, it creates one.
The lookup object remembers the class called &lt;code&gt;MethodHandles.lookup()&lt;/code&gt; to create one.
When loading a class hidden, it is required that the lookup object &quot;belongs&quot; to the class&amp;#8217;s package.
The lookup object was created, calling for it from a class, which is &lt;strong&gt;in&lt;/strong&gt; that package.
The lookup object will &quot;belong&quot; to that class and hence to the class&amp;#8217;s package.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To have a lookup object that comes from a class from a specific package we need a class in that package that can give us one.
If there is none in the code, we must create one dynamically.
&lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; does that exactly.
It creates the Java source code for the class, compiles it and loads it, instantiates it, and calls the  &lt;code&gt;Supplier&amp;lt;MethodHandles.Lookup&amp;gt;&lt;/code&gt; defined &lt;code&gt;get()&lt;/code&gt; method the class implements.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is a kind of trick that seems to violate the access control built-in to Java.
We seem to get a new hidden class in a package that was not prepared for it.
A package is protected from external access in Java (trivial).
Only public and protected members and classes can be used from outside the package.
The package can be accessed using reflection from the outside, but only in the same module, or the module has to be opened explicitly.
Similarly, an object loaded using a lookup object should be in the same package and access the package&amp;#8217;s internal members and whatnot if a class in the package provided that lookup.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As we can see from the error message, it only seems to be the package.
In reality, the new hidden class is in a package with the same name but in a different module.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to have a hidden class in the same package and not only a package with the same name, you need a lookup object from that package.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In our example, it is simple.
Our &lt;code&gt;Hello&lt;/code&gt; interface is in the same package as the test code so that we can create the lookup object ourselves:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1.         final var hi = Compiler.java().from(CODE1).hidden(MethodHandles.lookup()).compile()
2.                 .load().newInstance(Hello.class);
3.         hi.hello();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Access to a lookup object may be a bit more complex in real-life examples.
When the code calling &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; is in a different package than the code generated, the lookup object creation cannot be in the &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; calling code.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the following example, we will see how that will be done.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We have a class &lt;code&gt;OuterClass&lt;/code&gt; in the package &lt;code&gt;com.javax0.blog.hiddenclasses.otherpackage&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1. package com.javax0.blog.hiddenclasses.otherpackage;
 2.
 3. import java.lang.invoke.MethodHandles;
 4.
 5. public class OuterClass {
 6.
14.     public static MethodHandles.Lookup lookup() {
15.         return MethodHandles.lookup();
16.     }
17. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
Some lines are skipped from the class. We will use those later.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This class has a method, &lt;code&gt;lookup()&lt;/code&gt;.
It creates a lookup object and returns it.
We will have a proper lookup object if we call this method from our code.
Note that this class is in a different package and not the same as our test code.
Our test code is in &lt;code&gt;com.javax0.blog.hiddenclasses&lt;/code&gt;, and &lt;code&gt;OuterClass&lt;/code&gt; is a package deeper.
Essentially in a different package.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We also have another class for the demonstration.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;1. package com.javax0.blog.hiddenclasses.otherpackage;
2.
3. class MyPackagePrivateClass {
4.
5.     void sayHello(){
6.         System.out.println(&quot;Hello from package private.&quot;);
7.     }
8.
9. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is a package-private class with a package-private method in it.
If we dynamically create a hidden class, as in the following example:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         final var hidden = Compiler.java().from(&quot;&quot;&quot;
 2.                 package com.javax0.blog.hiddenclasses.otherpackage;
 3.
 4.                 public class AnyName_ItWillBeDropped_Anyway {
 5.                     public void hi(){
 6.                         new MyPackagePrivateClass().sayHello();
 7.                     }
 8.                 }&quot;&quot;&quot;).hidden(OuterClass.lookup()).compile().load().newInstance();
 9.         final var hi = hidden.getClass().getDeclaredMethod(&quot;hi&quot;);
10.         hi.invoke(hidden);&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It will work.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is one topic that we have not touched on.
It is how to create a nestmate.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you have a binary class file, you can load it as a nestmate to a class that provides a lookup object.
The JVM does not care how that class was created.
When we compile Java sources, we only have one possibility.
The class has to be an inner class.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When you use &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt;, you have to provide your source code as an inner class to the one you want the hidden to be nest mate with.
The source code and the class was already provided when you compiled your code.
It is not possible to insert into THAT source code any new inner class.
We have to fool the compiler.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We provide a class having the same name as the one we want to insert our inner class later.
When the compilation is done, we have the outer class and the inner class as well.
We tell the class loading to forget the outer and only to load the inner one, hidden.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is what we will do.
This time we display here the whole outer class that we use for demonstration including the skipped lines.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1. package com.javax0.blog.hiddenclasses.otherpackage;
 2.
 3. import java.lang.invoke.MethodHandles;
 4.
 5. public class OuterClass {
 6.
 7.     // skip lines
 8.     private int z = 55;
 9.
10.     public int getZ() {
11.         return z;
12.     }
13.     // end skip
14.     public static MethodHandles.Lookup lookup() {
15.         return MethodHandles.lookup();
16.     }
17. }&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As you will see, it has a private field and a getter to test the changed value effectively.
It also has the before-mentioned &lt;code&gt;lookup()&lt;/code&gt; method.
The code dynamically creating an inner class is the following:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         final var inner = Compiler.java().from(&quot;&quot;&quot;
 2.                         package com.javax0.blog.hiddenclasses.otherpackage;
 3.
 4.                         public class OuterClass
 5.                                                 {
 6.                             private int z;
 7.
 8.                             public static class StaticInner {
 9.                                public OuterClass a(){
10.                                  final var outer = new OuterClass();
11.                                  outer.z++;
12.                                  return outer;
13.                                }
14.                             }
15.
16.                         }&quot;&quot;&quot;).nest(MethodHandles.Lookup.ClassOption.NESTMATE).compile().load()
17.                 .newInstance(&quot;StaticInner&quot;);
18.         final var m = inner.getClass().getDeclaredMethod(&quot;a&quot;);
19.         final var outer = (OuterClass)m.invoke(inner);
20.         Assertions.assertEquals(56, outer.getZ());&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There is an &lt;code&gt;OuterClass&lt;/code&gt; in the source, but it is only to help the compilation and to tell &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; the name of the nesting host.
When we call the method &lt;code&gt;nest()&lt;/code&gt; with the option &lt;code&gt;NESTMATE&lt;/code&gt;, it knows that the class &lt;code&gt;OuterClass&lt;/code&gt; is the nesting host.
It also marks the class not to be loaded by the class loader ever.
The inner class compiles to a different byte code, and when it is loaded, it becomes a nestmate of &lt;code&gt;OuterClass&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you pay attention to the intricate details of Java access control discussed in this article, you will notice that we do not provide a lookup object.
And the example above still works.
How is it possible?
There is no magic.
When you call &lt;code&gt;nest()&lt;/code&gt;, &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; looks for the already loaded version of &lt;code&gt;OuterClass&lt;/code&gt; and fetches the lookup object using reflection.
To do that the outer class has to have a static field or method of type &lt;code&gt;MethodHandles.Lookup&lt;/code&gt;.
&lt;code&gt;OuterClass&lt;/code&gt; has a method, so &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt; calls this method to get the lookup object.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The example above creates a static inner class.
You can create the same way a non-static inner class as well.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The difference between static and non-static inner classes in Java is that non-static inner class instances have a reference to an outer class instance.
Static inner classes do not.
It is where the name comes from.
Static inner class instances belong to the class.
Non-static belongs to an instance of the outer class.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To get the reference to the outer class instance, the inner class&amp;#8217;s constructor is modified.
When you specify a constructor for an inner class, the compiled adds an extra parameter in front of the other parameters specified in the Java source code.
This extra first parameter is the reference to the outer class instance.
This reference is stored in a field not available at the source level but used by the code to access the fields and methods of the outer instance.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The creation of a non-static inner class looks very much the same as the creation of a static inner class:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt; 1.         final var outer = new OuterClass();
 2.         final var inner = Compiler.java().from(&quot;&quot;&quot;
 3.                         package com.javax0.blog.hiddenclasses.otherpackage;
 4.
 5.                         public class OuterClass {
 6.                             private int z;
 7.
 8.                             public class Inner {
 9.                                public void a(){
10.                                  z++;
11.                                }
12.                             }
13.
14.                         }&quot;&quot;&quot;).nest(MethodHandles.Lookup.ClassOption.NESTMATE).compile().load()
15.                 .newInstance(&quot;Inner&quot;, classes(OuterClass.class), args(outer));
16.         final var m = inner.getClass().getDeclaredMethod(&quot;a&quot;);
17.         m.invoke(inner);
18.         Assertions.assertEquals(56, outer.getZ());&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We need an instance of the outer class to instantiate the inner class.
It is the variable &lt;code&gt;outer&lt;/code&gt;.
We must pass this variable to the constructor through the &lt;code&gt;newInstance()&lt;/code&gt; API of &lt;a href=&quot;https://github.com/sourcebuddy/sourcebuddy&quot;&gt;SourceBuddy&lt;/a&gt;.
This method call has a version that accepts a &lt;code&gt;Class[]&lt;/code&gt; and an &lt;code&gt;Object[]&lt;/code&gt; array specifying the constructor argument types and values.
In the case of an inner class, it is the outer class and an instance.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;6-summary&quot;&gt;6. Summary&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This article discussed some details of the hidden classes introduced in Java 15.
We went a little deeper than the usual introductory articles.
Now you understand how hidden classes work and how to use them in your projects.&lt;/p&gt;
&lt;/div&gt;
&lt;details&gt;
&lt;summary class=&quot;title&quot;&gt;How to Comment&lt;/summary&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;sidebarblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Use the Disqus commenting possibility to comment.
If you find any incorrectness in the article, you are welcome to mention it.
You can also access the source code of the article on github at&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-05-hidden-classes.adoc.jam&quot;&gt;&lt;code&gt;https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-05-hidden-classes.adoc.jam&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You are welcome to create a &lt;a href=&quot;https://github.com/javax0/javax0.github.io/issues/new&quot;&gt;ticket&lt;/a&gt;, create a  &lt;a href=&quot;https://github.com/javax0/javax0.github.io/fork&quot;&gt;fork&lt;/a&gt;, suggest modification via pull requests.
Note that this repository also contains the demonstration sample source code.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For other aspects of commenting read the &lt;a href=&quot;https://javax0.github.io/about/&quot;&gt;ABOUT&lt;/a&gt; page of this blog.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/details&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">Article Management Technical Details Code https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-05-hidden-classes Article source https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-05-hidden-classes.adoc.jam 1. Introduction</summary></entry><entry><title type="html">Technology behind this post</title><link href="https://javax0.github.io/2022/12/07/blog-posting.html" rel="alternate" type="text/html" title="Technology behind this post" /><published>2022-12-07T00:00:00+01:00</published><updated>2022-12-07T00:00:00+01:00</updated><id>https://javax0.github.io/2022/12/07/blog-posting</id><content type="html" xml:base="https://javax0.github.io/2022/12/07/blog-posting.html">&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;1-introduction&quot;&gt;1. Introduction&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;/Users/verhasp/github/javax0.github.io/_posts&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This blog is the continuation of the blog post at the WordPress-hosted javax0 blog that was at &lt;a href=&quot;https://javax0.wordpress.com&quot;&gt;javax0.wordpress.com&lt;/a&gt;.
The technology, the hosting, and all were okay by that time, but times changed.
This blog post describes why I changed the blog technology and what technology I use here to write these blog posts.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;2-problems-with-wordpress&quot;&gt;2. Problems with WordPress&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First, I have to state that I am not saying or implying that WordPress would not be an excellent platform.
It is a well-established and a kind of one of its kind, de-facto number-one blogging forum.
The problems are specific to my particular needs for this blog.
These needs may not be specific to my person, but a bit more general: technical blogging.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It is like Opel, Toyota, VW, or any other average, workhorse car type.
Opel is a good car; it runs, is reliable, and is reasonably priced.
However, if I am a farmer and need to plow my fields, I will probably choose a tractor instead.
In this analogy, the farmer is a &lt;em&gt;technical&lt;/em&gt; blogger.
Emphasis is on &lt;em&gt;technical&lt;/em&gt;.
For anybody else: WordPress is an excellent choice.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Let&amp;#8217;s have a look at the issues that I had.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-1-markup&quot;&gt;2.1. Markup&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When I write anything, I like to edit some markup.
I can use Word or LibreOffice.
I was using DEC Write in the early 1990-is if you are old enough to know what that is but not too old to forget things and still remember.
Even at that time, I preferred markups, which at that time were TeX and LaTeX.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I even wrote a hyphenation preprocessor for Tex for the Hungarian language, and it became a standard part of some Linux distributions.
Since they installed Linux on  Mars Rovers, sometimes I entertain myself with the idea that some of my code got as far as planet Mars.
Please let me have this fantasy, and do not correct me if I am wrong.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We could use other markups, like APT, Markdown, Asciidoc, and many others over the years.
These days two of those are used mainly, Markdown and Asciidoc.
WordPress hosted site supported or still supports Markdown, but I started to prefer Asciidoc for these blogs.
The only problem was that I could not.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-2-code-samples&quot;&gt;2.2. Code Samples&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When I write some technical blogs, I include code samples.
I develop the code first, and then I write the article.
That is the principle.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However, the practice is that after I started to write the article, I realized that the code was not perfect.
So I changed the code and copied the relevant part to the article sample displays.
Unless I forget to update some of those after a few iterations.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It was also the case when I wrote my first book, and I have sworn that it will never happen again.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;2-3-version-control&quot;&gt;2.3. Version Control&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Editing on WordPress works, and you can look at the different versions.
But it is not comparable with the possibilities provided by a Git repository.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;3-the-new-blog-technology&quot;&gt;3. The New Blog Technology&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-1-github-pages-and-jekyll&quot;&gt;3.1. Github Pages and Jekyll&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The new technology stack for blogging is based on GitHub pages.
It is not unique, and it has support for Jekyll, which is a static blogging engine.
Setting up a Jekyll-based blog is pretty straightforward.
I already had the organization name &lt;code&gt;javax0&lt;/code&gt; on GitHub.
It only seemed logical to use this as &lt;code&gt;javax0.github.io&lt;/code&gt; for blogging.
Later I may use the &lt;code&gt;javax0.com&lt;/code&gt; domain that I also keep.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Installing Jekyll on my MacBook was a bit tricky.
First, I had to install the newest Ruby.
An old version of Ruby comes preinstalled on every macOS.
This old version is not suitable for running Jekyll.
I used brew, but it failed, complaining that I was not on the sudoer list.
It took a while until I realized that, for some reason, two &lt;code&gt;sudo&lt;/code&gt; programs were installed on my machine.
The brew installer used a different one than what I reached from the command line.
I had to add myself to the other sudoer&amp;#8217;s list as well.
The last trick was to tweak the &lt;code&gt;PATH&lt;/code&gt; so Jekyll would use the newest Ruby version.
After that, there was still some problem when I configured Jekyll to run locally and on GitHub.
It was executing some commands following some StackOverflow page suggestions.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Sometimes I had no idea what I was doing.
I can only hope that I did not install malware during the process.
You, AsciiDoc, Jekyll, and other tool developers have all my trust.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I integrated JRuby into Jamal, but I do not program in Ruby.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-2-jekyll-asciidoc-plugin&quot;&gt;3.2. Jekyll Asciidoc Plugin&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In addition to Jekyll, I also installed the Asciidoc plugin for Jekyll.
Since both Asciidoctor and Jekyll are written in Ruby, it was nothing more than issuing a few commands.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-3-jamal&quot;&gt;3.3. Jamal&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The extra part, which is not a standard Asciidoc-boosted Jekyll installation, is my use of Jamal.
The main reason to use Jamal is to include the code samples in the blog posts, but it does much more than that.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I wrote above that I struggled with maintaining the code samples when writing my books.
I created the pyama tool in Python for the second book I wrote.
It copies the code snippets into the text file that I edited.
Later I developed the snippet module for Jamal, which revolves around this concept.
Keep the source in the code files, have only a reference in the document, and copy it in the CI/CD process.
I hesitated to use Jamal and the snipped module myself for a long time.
It is easier to edit a file showing some code when the code is there a few lines above.
Pyama was copying the code into the edited file.
Jamal does not do that.
Jamal can also do that, but I do not recommend using that feature.
A source file is a source file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When I created the Asciidoctor Jamal plugin that can plug Jamal functionality into Asciidoctor and delivers Jamal WYSIWYG editing in IntelliJ, the situation changed drastically.
There was no reason more to use something like pyama.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
Pyama is still available in my GitHub, but there are much better tools for the purpose.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Using Jamal, I can include code snippets and delete or keep some lines by selecting regular expressions or line numbers.
I can number the lines, and I can still use all the Asciidoctor formatting features at the same time.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-4-installing-jamal&quot;&gt;3.4. Installing Jamal&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Installing Jamal to use in IntelliJ is very simple.
All it takes to download a ZIP file and extract the content into the projects &lt;code&gt;.asciidoctor/lib&lt;/code&gt; directory.
You should open IntelliJ settings and associate the &lt;code&gt;.jam&lt;/code&gt; extension with the Asciidoctor plugin (in addition to the other default extensions already there).
Restart IntelliJ, and you can start editing your first Jamal-enabled Asciidoc file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As you edit the file on the left pane, you see the formatted text on the right pane.
It is how the plugin works, but you can also use Jamal macros now.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;https://javax0.github.io/assets/images/image-2022-12-09-16-47-43-394.png&quot; alt=&quot;image 2022 12 09 16 47 43 394&quot; width=&quot;500&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-5-blogging-macros&quot;&gt;3.5. Blogging Macros&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are not too many specific macros that differ from other documentation macros.
Most of the macros I use in Jamal are snippet macros and built-in core ones.
Some macros help scan the snippets following the directory naming conventions of the site.
There are some macros to reference one article from another easily.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;3-6-deploying-the-site&quot;&gt;3.6. Deploying the Site&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Deployment of the site is simply a git push.
Almost.
The site has to be built before.
There is a simple build script:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;#!/bin/sh
./build
git add --all docs
git commit -m &quot;deploy&quot;
git push
open https://javax0.github.io&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This script builds the site, adds all the new and modified generated files, and then pushes it to the git server.
It also opens the web page, so I can immediately see the blog&amp;#8217;s opening page after it is deployed.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I tried to let GitHub pages do the building of the Jekyll site.
After all, it supports Jekyll.
The problem is that GitHub does not support the Jekyll Asciidoc plugin.
It is a bit strange: Asciidoc is natively supported by GitHub, and any readme or other files can be Asciidoc.
Still, GitHub Sites cannot be, except if they are built and deployed elsewhere.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;4-building-the-site&quot;&gt;4. Building the site&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;div class=&quot;title&quot;&gt;update at 2023-01-25&lt;/div&gt;
&lt;p&gt;Building the site was first was a simple &lt;code&gt;Makefile&lt;/code&gt; starting Jamal via &lt;code&gt;jbang&lt;/code&gt; to convert all the &lt;code&gt;.adoc.jam&lt;/code&gt; files to &lt;code&gt;.adoc&lt;/code&gt; from the directory &lt;code&gt;_posts&lt;/code&gt;.
This, however, resulted almost 400 files in the directory.
During the course of the last ten years I wrote 180 articles.
All their &lt;code&gt;.adoc.jam&lt;/code&gt; and the generated &lt;code&gt;.adoc&lt;/code&gt; files got into one flat directory.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To mitigate this situation I decided to group the articles into subdirectories by years.
It means eleven subdirectories now and 15 to 20 more in my lifetime.
It is manageable.
The problem was I did not know how to write a general &lt;code&gt;make&lt;/code&gt; rule that says &lt;code&gt;.adoc.jam&lt;/code&gt; files in the subdirectories should be compiled to &lt;code&gt;.adoc&lt;/code&gt; files in the &lt;code&gt;_posts&lt;/code&gt; directory.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I used Jamal to the rescue.
What else?
I created a &lt;code&gt;Makefile.jam&lt;/code&gt; with the following content:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;{@sep [% %] }[%@import tab.jim%]\
all:  [%!@for [evalist] $file in `//` [%@listDir (pattern=&quot;\\.adoc\\.jam$&quot;) _posts%]`//` =[%@comment%]\
 _posts/[%@file (format=$naked1)$file%]%]\

[%!!#for $dir in ([%@listDir (maxDepth=1 pattern=&quot;/\\d{4}$&quot;)_posts%])=[%@comment%]\
  [%@ident
    [%@for [evalist] $file in `//` [%@listDir (maxDepth=1 pattern=&quot;\\.adoc\\.jam$&quot;) $dir%]`//` =[%@comment%]\
    [%#define YYYY=[%#replace (regex)|$dir|.*/_posts/||%]%]\
    [%#define SOURCE=_posts/[%YYYY%]/[%#file (format=$simpleName)$file%]%]\
    [%#define TARGET=_posts/[%@file (format=$naked1)$file%]%]
[%TARGET%] : [%SOURCE%]
[%HT%]jbang jamal@verhas -open=&apos;{%&apos; -close=&apos;%}&apos; [%SOURCE%] [%TARGET%]
    %]%]%]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I do not expect you to understand this structure.
It is fairly complex,but it shows the power of Jamal in some way.
You should not feel intimidated.
If you decide to use Jamal only for 10% of what it can do, it is fine.
It is a tool to provide value and not something you need to master.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This Jamal code lists all the files and generates &lt;code&gt;Makefile&lt;/code&gt; rules for each &lt;code&gt;.adoc.jam&lt;/code&gt; article.
I struggled a bit with spaces and tabs.
IntelliJ does not preserve the tabs, except when it is a &lt;code&gt;Makefile&lt;/code&gt;.
However, &lt;code&gt;Makefile.jam&lt;/code&gt; is NOT &lt;code&gt;Makefile&lt;/code&gt;.
As a workaround I created a &lt;code&gt;tab.jim&lt;/code&gt; file:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;{@define HT=	} &amp;lt;- this is a tab character
A simple tab character.

This file is not to be edited other than vi.
Other editors may replace the TAB character with spaces.
Files can import this file and use {HT} in Makefiles.
To exit vi press the escape key and then capital Z twice.
Without saving: escsape and then :q!&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The comment in the file says it all, I wil not repeat here.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I may later move the &lt;code&gt;YYYY&lt;/code&gt; yearly subdirectories from &lt;code&gt;_posts&lt;/code&gt; to make the &lt;code&gt;_posts&lt;/code&gt; directory something that I never need to open in the editor.
Look at the GitHub repo to see if I did that.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;5-what-will-be-missing&quot;&gt;5. What will be Missing&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;WordPress very neatly showed the statistics of the site.
I do not know if I can get such statistics here.
Probably not.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On the other hand, most of the readers for my articles came from the republishing sites DZone and Java Code Geeks.
I will keep them.
(Note to myself: I have to inform them about the blog&amp;#8217;s new location officially.)
They automatically fetch the blog posts.
So I do not need to do anything.
They select from the published articles.
They only repost the good ones.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you know any other aggregator I should contact, give me some advice. I am open.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;6-summary&quot;&gt;6. Summary&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I hope blogging using this toolset will be much more fun than the old technology.
At least, I am less likely to end up in some articles with &lt;code&gt;&amp;amp;lt;&lt;/code&gt; and &lt;code&gt;&amp;amp;gt;&lt;/code&gt; infested source codes.
(I had to apply a unique trick to get them here.)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This type of blogging using Asciidoc, Jekyll, and Jamal is more a Doc as a Code that I advocate heavily.
We will see how it will work.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">1. Introduction</summary></entry></feed>